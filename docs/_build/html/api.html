
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>VoigtFit Interface &#8212; VoigtFit 0.11.6 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="VoigtFit Parameter Language" href="documentation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <pre class="logo literal-block">
____  _           _________________________________________
    \/ \  _/\    /
        \/   \  / oigtFit
              \/
</pre>
<div class="section" id="voigtfit-interface">
<h1>VoigtFit Interface<a class="headerlink" href="#voigtfit-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="class-dataset">
<h2>class <strong>DataSet</strong><a class="headerlink" href="#class-dataset" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="VoigtFit.DataSet">
<em class="property">class </em><code class="descclassname">VoigtFit.</code><code class="descname">DataSet</code><span class="sig-paren">(</span><em>redshift</em>, <em>name=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Main class of the package <code class="docutils literal notranslate"><span class="pre">VoigtFit</span></code>. The DataSet handles all the major parts of the fit.
Spectral data must be added using the <a class="reference internal" href="#VoigtFit.DataSet.add_data" title="VoigtFit.DataSet.add_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_data</span></code></a> method.
Hereafter the absorption lines to be fitted are added to the DataSet using the
<a class="reference internal" href="#VoigtFit.DataSet.add_line" title="VoigtFit.DataSet.add_line"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_line</span></code></a> or
<a class="reference internal" href="#VoigtFit.DataSet.add_many_lines" title="VoigtFit.DataSet.add_many_lines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_many_lines</span></code></a> methods.
Lastly, the components of each element is defined using the
<a class="reference internal" href="#VoigtFit.DataSet.add_component" title="VoigtFit.DataSet.add_component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_component</span></code></a> method.
When all lines and components have been defined, the DataSet must be prepared by
calling the <a class="reference internal" href="#VoigtFit.DataSet.prepare_dataset" title="VoigtFit.DataSet.prepare_dataset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_dataset</span></code></a>
method and subsequently, the lines can be fitted using
the <a class="reference internal" href="#VoigtFit.DataSet.fit" title="VoigtFit.DataSet.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a> method.</p>
<p class="rubric">Attributes</p>
<dl class="docutils">
<dt>redshift <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Systemic redshift of the absorption system.</dd>
<dt>name <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = ‘’]</span></dt>
<dd>The name of the DataSet, this will be used for saving the dataset to a file structure.</dd>
<dt>verbose <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd>If <cite>False</cite>, the printed information statements will be suppressed.</dd>
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">list(data_chunks)</span></dt>
<dd>A list of <em>data chunks</em> defined for the dataset. A <em>data chunk</em> is
a dictionary with keys ‘wl’, ‘flux’, ‘error’, ‘res’, ‘norm’.
See <a class="reference internal" href="#VoigtFit.DataSet.add_data" title="VoigtFit.DataSet.add_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.add_data</span></code></a>.</dd>
<dt>lines <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd>A dictionary holding pairs of defined (<em>line_tag</em> : <code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code>)</dd>
<dt>all_lines <span class="classifier-delimiter">:</span> <span class="classifier">list(str)</span></dt>
<dd>A list of all the defined <em>line tags</em> for easy look-up.</dd>
<dt>molecules <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd>A dictionary holding a list of the defined molecular bands and Jmax
for each molecule:
<code class="docutils literal notranslate"><span class="pre">{molecule*</span> <span class="pre">:</span> <span class="pre">[[band1,</span> <span class="pre">Jmax1],&nbsp;[band2,</span> <span class="pre">Jmax2],</span> <span class="pre">etc...]}</span></code></dd>
<dt>regions <span class="classifier-delimiter">:</span> <span class="classifier">list(<a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">regions.Region</span></code></a>)</span></dt>
<dd>A list of the fitting regions.</dd>
<dt>cheb_order <span class="classifier-delimiter">:</span> <span class="classifier">int   [default = -1]</span></dt>
<dd>The maximum order of Chebyshev polynomials to use for the continuum
fitting in each region. If negative, the Chebyshev polynomials will
not be included in the fit.</dd>
<dt>norm_method <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = ‘linear’]</span></dt>
<dd>Default normalization method to use for interactive normalization
if Chebyshev polynomial fitting should not be used.</dd>
<dt>components <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd>A dictionary of components for each <em>ion</em> defined:
(<em>ion</em> : [z, b, logN, options]). See <a class="reference internal" href="#VoigtFit.DataSet.add_component" title="VoigtFit.DataSet.add_component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.add_component</span></code></a>.</dd>
<dt>velspan <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = 500]</span></dt>
<dd>The default velocity range to use for the definition
of fitting regions.</dd>
<dt>ready2fit <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd>This attribute is checked before fitting the dataset. Only when
the attribute has been set to <cite>True</cite> can the dataset be fitted.
This will be toggled after a successful run of
<a class="reference internal" href="#VoigtFit.DataSet.prepare_dataset" title="VoigtFit.DataSet.prepare_dataset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.prepare_dataset</span></code></a>.</dd>
<dt>best_fit <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a>   [default = None]</span></dt>
<dd>Best-fit parameters from <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a>.
This attribute will be <cite>None</cite> until the dataset has been fitted.</dd>
<dt>pars <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a>   [default = None]</span></dt>
<dd>Placeholder for the fit parameters initiated before the fit.
The parameters will be defined during the call to <a class="reference internal" href="#VoigtFit.DataSet.prepare_dataset" title="VoigtFit.DataSet.prepare_dataset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.prepare_dataset</span></code></a> based on the defined components.</dd>
</dl>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.activate_all" title="VoigtFit.DataSet.activate_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activate_all</span></code></a>()</td>
<td>Activate all lines defined in the DataSet.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.activate_fine_lines" title="VoigtFit.DataSet.activate_fine_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activate_fine_lines</span></code></a>(line_tag[,&nbsp;levels])</td>
<td>Activate all lines associated to a given fine-structure complex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.activate_line" title="VoigtFit.DataSet.activate_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activate_line</span></code></a>(line_tag)</td>
<td>Activate a given line defined by its <cite>line_tag</cite></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.activate_molecule" title="VoigtFit.DataSet.activate_molecule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activate_molecule</span></code></a>(molecule,&nbsp;band)</td>
<td>Activate all lines for the given band of the given molecule.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.add_component" title="VoigtFit.DataSet.add_component"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_component</span></code></a>(ion,&nbsp;z,&nbsp;b,&nbsp;logN[,&nbsp;var_z,&nbsp;…])</td>
<td>Add component for a given ion.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.add_component_velocity" title="VoigtFit.DataSet.add_component_velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_component_velocity</span></code></a>(ion,&nbsp;v,&nbsp;b,&nbsp;logN[,&nbsp;…])</td>
<td>Same as for <a class="reference internal" href="#VoigtFit.DataSet.add_component" title="VoigtFit.DataSet.add_component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_component</span></code></a> but input is given as relative velocity instead of redshift.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.add_data" title="VoigtFit.DataSet.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(wl,&nbsp;flux,&nbsp;res[,&nbsp;err,&nbsp;normalized,&nbsp;…])</td>
<td>Add spectral data to the DataSet.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.add_fine_lines" title="VoigtFit.DataSet.add_fine_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fine_lines</span></code></a>(line_tag[,&nbsp;levels,&nbsp;…])</td>
<td>Add fine-structure line complexes by providing only the main transition.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.add_line" title="VoigtFit.DataSet.add_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_line</span></code></a>(line_tag[,&nbsp;velspan,&nbsp;active])</td>
<td>Add an absorption line to the DataSet.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.add_lines" title="VoigtFit.DataSet.add_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lines</span></code></a>(line_tags[,&nbsp;velspan])</td>
<td>Alias for <cite>self.add_many_lines</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.add_many_lines" title="VoigtFit.DataSet.add_many_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_many_lines</span></code></a>(tags[,&nbsp;velspan])</td>
<td>Add many lines at once.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.add_molecule" title="VoigtFit.DataSet.add_molecule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_molecule</span></code></a>(molecule,&nbsp;band[,&nbsp;Jmax,&nbsp;…])</td>
<td>Add molecular lines for a given band, e.g., “AX(0-0)” of CO.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.add_spectrum" title="VoigtFit.DataSet.add_spectrum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_spectrum</span></code></a>(filename,&nbsp;res[,&nbsp;normalized,&nbsp;…])</td>
<td>Add spectral data from ASCII file (three or four columns accepted).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.all_active_lines" title="VoigtFit.DataSet.all_active_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_active_lines</span></code></a>()</td>
<td>Returns a list of all the active lines defined by their <cite>line_tag</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.clear_mask" title="VoigtFit.DataSet.clear_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_mask</span></code></a>(line_tag[,&nbsp;idx])</td>
<td>Clear the mask for the <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a> containing the given <cite>line_tag</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.copy_components" title="VoigtFit.DataSet.copy_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_components</span></code></a>([to_ion,&nbsp;from_ion,&nbsp;logN,&nbsp;…])</td>
<td>Copy velocity structure to <cite>ion</cite> from another <cite>ion</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.deactivate_all" title="VoigtFit.DataSet.deactivate_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deactivate_all</span></code></a>()</td>
<td>Deactivate all lines defined in the DataSet.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.deactivate_fine_lines" title="VoigtFit.DataSet.deactivate_fine_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deactivate_fine_lines</span></code></a>(line_tag[,&nbsp;levels,&nbsp;…])</td>
<td>Deactivate all lines associated to a given fine-structure complex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.deactivate_line" title="VoigtFit.DataSet.deactivate_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deactivate_line</span></code></a>(line_tag)</td>
<td>Deactivate a given line defined by its <cite>line_tag</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.deactivate_molecule" title="VoigtFit.DataSet.deactivate_molecule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deactivate_molecule</span></code></a>(molecule,&nbsp;band)</td>
<td>Deactivate all lines for the given band of the given molecule.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.delete_component" title="VoigtFit.DataSet.delete_component"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_component</span></code></a>(ion,&nbsp;index)</td>
<td>Remove component of the given <cite>ion</cite> with the given <cite>index</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.find_ion" title="VoigtFit.DataSet.find_ion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_ion</span></code></a>(ion)</td>
<td>Return a list of all line tags for a given ion.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.find_line" title="VoigtFit.DataSet.find_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_line</span></code></a>(line_tag)</td>
<td>Look up the fitting <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a> for a given <em>line tag</em>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.fit" title="VoigtFit.DataSet.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>([verbose])</td>
<td>Fit the absorption lines using chi-square minimization.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.fix_structure" title="VoigtFit.DataSet.fix_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_structure</span></code></a>([ion])</td>
<td>Fix the velocity structure, that is, the redshifts and the b-parameters.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.free_structure" title="VoigtFit.DataSet.free_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">free_structure</span></code></a>([ion])</td>
<td>Free the velocity structure, that is, the redshifts and the b-parameters.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.get_lines_for_ion" title="VoigtFit.DataSet.get_lines_for_ion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lines_for_ion</span></code></a>(ion)</td>
<td>Return a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> objects corresponding to the given <em>ion</em>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.get_name" title="VoigtFit.DataSet.get_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_name</span></code></a>()</td>
<td>Returns the name of the DataSet.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.get_resolution" title="VoigtFit.DataSet.get_resolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolution</span></code></a>(line_tag[,&nbsp;verbose])</td>
<td>Return the spectral resolution for the fitting <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a> where the line with the given <cite>line_tag</cite> is defined.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.has_ion" title="VoigtFit.DataSet.has_ion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_ion</span></code></a>(ion[,&nbsp;active_only])</td>
<td>Return True if the dataset has lines defined for the given ion.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.has_line" title="VoigtFit.DataSet.has_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_line</span></code></a>(line_tag[,&nbsp;active_only])</td>
<td>Return True if the given line is defined.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.interactive_components" title="VoigtFit.DataSet.interactive_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interactive_components</span></code></a>(line_tag[,&nbsp;velocity])</td>
<td>Define components interactively for a given ion.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.load_components_from_file" title="VoigtFit.DataSet.load_components_from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_components_from_file</span></code></a>(fname[,&nbsp;fit_pars])</td>
<td>Load best-fit parameters from an output file <cite>fname</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.mask_line" title="VoigtFit.DataSet.mask_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_line</span></code></a>(line_tag[,&nbsp;reset,&nbsp;mask,&nbsp;telluric,&nbsp;…])</td>
<td>Define exclusion masks for the fitting region of a given line.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.mask_range" title="VoigtFit.DataSet.mask_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_range</span></code></a>(line_tag,&nbsp;x1,&nbsp;x2[,&nbsp;idx])</td>
<td>Define mask in a range from <cite>x1</cite> to <cite>x2</cite> in velocity space.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.normalize_line" title="VoigtFit.DataSet.normalize_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize_line</span></code></a>(line_tag[,&nbsp;norm_method,&nbsp;velocity])</td>
<td>Normalize or re-normalize a given line</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.plot_fit" title="VoigtFit.DataSet.plot_fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_fit</span></code></a>([rebin,&nbsp;fontsize,&nbsp;xmin,&nbsp;xmax,&nbsp;…])</td>
<td>Plot <em>all</em> the absorption lines and the best-fit profiles.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.plot_line" title="VoigtFit.DataSet.plot_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_line</span></code></a>(line_tag[,&nbsp;index,&nbsp;plot_fit,&nbsp;loc,&nbsp;…])</td>
<td>Plot a single fitting <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a> containing the line corresponding to the given <cite>line_tag</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.prepare_dataset" title="VoigtFit.DataSet.prepare_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_dataset</span></code></a>([norm,&nbsp;mask,&nbsp;verbose,&nbsp;…])</td>
<td>Prepare the data for fitting.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.print_cont_parameters" title="VoigtFit.DataSet.print_cont_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_cont_parameters</span></code></a>()</td>
<td>Print Chebyshev coefficients for the continuum fit.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.print_metallicity" title="VoigtFit.DataSet.print_metallicity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_metallicity</span></code></a>(logNHI[,&nbsp;err])</td>
<td>Print the total column densities for each element relative to HI in Solar units.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.print_results" title="VoigtFit.DataSet.print_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_results</span></code></a>([velocity,&nbsp;elements,&nbsp;systemic])</td>
<td>Print the best fit parameters.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.print_total" title="VoigtFit.DataSet.print_total"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_total</span></code></a>()</td>
<td>Print the total column densities of all components.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.remove_fine_lines" title="VoigtFit.DataSet.remove_fine_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_fine_lines</span></code></a>(line_tag[,&nbsp;levels])</td>
<td>Remove lines associated to a given fine-structure complex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.remove_line" title="VoigtFit.DataSet.remove_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_line</span></code></a>(line_tag)</td>
<td>Remove an absorption line from the DataSet.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.remove_molecule" title="VoigtFit.DataSet.remove_molecule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_molecule</span></code></a>(molecule,&nbsp;band)</td>
<td>Remove all lines for the given band of the given molecule.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.reset_all_regions" title="VoigtFit.DataSet.reset_all_regions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_all_regions</span></code></a>()</td>
<td>Reset the data in all <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regions</span></code></a> defined in the DataSet to use the raw input data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.reset_components" title="VoigtFit.DataSet.reset_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_components</span></code></a>([ion])</td>
<td>Reset component structure for a given ion.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.reset_region" title="VoigtFit.DataSet.reset_region"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_region</span></code></a>(reg)</td>
<td>Reset the data in a given <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">regions.Region</span></code></a> to use the raw input data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.save" title="VoigtFit.DataSet.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>([filename,&nbsp;verbose])</td>
<td>Save the DataSet to file using the HDF5 format.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.save_cont_parameters_to_file" title="VoigtFit.DataSet.save_cont_parameters_to_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_cont_parameters_to_file</span></code></a>(filename)</td>
<td>Save the best-fit continuum parameters to ASCII table output.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.save_fit_regions" title="VoigtFit.DataSet.save_fit_regions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_fit_regions</span></code></a>([filename,&nbsp;individual,&nbsp;path])</td>
<td>Save the fitting regions to ASCII table output.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.save_parameters" title="VoigtFit.DataSet.save_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_parameters</span></code></a>(filename)</td>
<td>Save the best-fit parameters to ASCII table output.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.set_name" title="VoigtFit.DataSet.set_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_name</span></code></a>(name)</td>
<td>Set the name of the DataSet.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.set_resolution" title="VoigtFit.DataSet.set_resolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_resolution</span></code></a>(res[,&nbsp;line_tag,&nbsp;verbose,&nbsp;nsub])</td>
<td>Set the spectral resolution in km/s for the <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a> containing the line with the given <cite>line_tag</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.set_systemic_redshift" title="VoigtFit.DataSet.set_systemic_redshift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_systemic_redshift</span></code></a>(z_sys)</td>
<td>Update the systemic redshift of the dataset</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.show_components" title="VoigtFit.DataSet.show_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">show_components</span></code></a>([ion])</td>
<td>Show the defined components for a given <cite>ion</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.show_lines" title="VoigtFit.DataSet.show_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">show_lines</span></code></a>()</td>
<td>Print all defined lines to terminal.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#VoigtFit.DataSet.sum_components" title="VoigtFit.DataSet.sum_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum_components</span></code></a>(ions[,&nbsp;components])</td>
<td>Calculate the total column density for the given <cite>components</cite> of the given <cite>ion</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#VoigtFit.DataSet.velocity_plot" title="VoigtFit.DataSet.velocity_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity_plot</span></code></a>(**kwargs)</td>
<td>Create a velocity plot, showing all the fitting regions defined, in order to compare different lines and to identify blends and contamination.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="67%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>get_NHI</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>remove_all_lines</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="VoigtFit.DataSet.activate_all">
<code class="descname">activate_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.activate_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.activate_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Activate all lines defined in the DataSet.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.activate_fine_lines">
<code class="descname">activate_fine_lines</code><span class="sig-paren">(</span><em>line_tag</em>, <em>levels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.activate_fine_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.activate_fine_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Activate all lines associated to a given fine-structure complex.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The line tag of the ground state transition to activate.</p>
</dd>
<dt><strong>levels</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, list(str)   [default = None]</span></dt>
<dd><p class="first last">The levels of the fine-structure complexes to activate,
with the string “a” referring to the first excited level,
“b” is the second, etc…
Several levels can be given at once as a list: [‘a’, ‘b’]
or as a concatenated string: ‘abc’.
By default, all levels are included.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.activate_line">
<code class="descname">activate_line</code><span class="sig-paren">(</span><em>line_tag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.activate_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.activate_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Activate a given line defined by its <cite>line_tag</cite></p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.activate_molecule">
<code class="descname">activate_molecule</code><span class="sig-paren">(</span><em>molecule</em>, <em>band</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.activate_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.activate_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Activate all lines for the given band of the given molecule.</p>
<blockquote>
<div><ul class="simple">
<li>Ex: <code class="docutils literal notranslate"><span class="pre">activate_molecule('CO',</span> <span class="pre">'AX(0-0)')</span></code></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.add_component">
<code class="descname">add_component</code><span class="sig-paren">(</span><em>ion</em>, <em>z</em>, <em>b</em>, <em>logN</em>, <em>var_z=True</em>, <em>var_b=True</em>, <em>var_N=True</em>, <em>tie_z=None</em>, <em>tie_b=None</em>, <em>tie_N=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_component"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.add_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Add component for a given ion. Each component defined will be used for all transitions
defined for a given ion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The ion for which to define a component: e.g., “FeII”, “HI”, “CIa”, etc.</p>
</dd>
<dt><strong>z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The redshift of the component.</p>
</dd>
<dt><strong>b</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The effective broadening parameter for the component in km/s.
This parameter is constrained to be in the interval [0 - 1000] km/s.</p>
</dd>
<dt><strong>logN</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The 10-base logarithm of the column density of the component.
The column density is expected in cm^-2.</p>
</dd>
<dt><strong>var_z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If <cite>False</cite>, the redshift of the component will be kept fixed.</p>
</dd>
<dt><strong>var_b</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If <cite>False</cite>, the b-parameter of the component will be kept fixed.</p>
</dd>
<dt><strong>var_N</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If <cite>False</cite>, the column density of the component will be kept fixed.</p>
</dd>
<dt><strong>tie_z, tie_b, tie_N</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = None]</span></dt>
<dd><p class="first last">Parameter constraints for the different variables.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The ties are defined relative to the parameter names. The naming is as follows:
The redshift of the first component of FeII is called “z0_FeII”,
the logN of the second component of SiII is called “logN1_SiII”.
For more information about parameter ties, see the documentation for <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a>.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.add_component_velocity">
<code class="descname">add_component_velocity</code><span class="sig-paren">(</span><em>ion</em>, <em>v</em>, <em>b</em>, <em>logN</em>, <em>var_z=True</em>, <em>var_b=True</em>, <em>var_N=True</em>, <em>tie_z=None</em>, <em>tie_b=None</em>, <em>tie_N=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_component_velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.add_component_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as for <a class="reference internal" href="#VoigtFit.DataSet.add_component" title="VoigtFit.DataSet.add_component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_component</span></code></a>
but input is given as relative velocity instead of redshift.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>wl</em>, <em>flux</em>, <em>res</em>, <em>err=None</em>, <em>normalized=False</em>, <em>mask=None</em>, <em>nsub=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Add spectral data to the DataSet. This will be used to define fitting regions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>wl</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (n)</span></dt>
<dd><p class="first last">Input vacuum wavelength array in Ångstrøm.</p>
</dd>
<dt><strong>flux</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (n)</span></dt>
<dd><p class="first last">Input flux array, should be same length as wl</p>
</dd>
<dt><strong>res</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or string</span></dt>
<dd><p class="first last">Spectral resolution either given in km/s  (c/R),
which is assumed to be constant over the whole spectrum,
or as a string referring to a file containing the detailed
line-spread function for the given spectrum.
See details in the data section of the <a class="reference internal" href="documentation.html#documentation"><span class="std std-ref">VoigtFit Parameter Language</span></a>.</p>
</dd>
<dt><strong>err</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape (n)   [default = None]</span></dt>
<dd><p class="first last">Error array, should be same length as wl
If <cite>None</cite> is given, an uncertainty of 1 is given to all pixels.</p>
</dd>
<dt><strong>normalized</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If the input spectrum is normalized this should be given as True
in order to skip normalization steps.</p>
</dd>
<dt><strong>mask</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array, shape (n)</span></dt>
<dd><p class="first last">Boolean/int array defining the fitting regions.
Only pixels with mask=True/1 will be included in the fit.</p>
</dd>
<dt><strong>nsub</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">Kernel subsampling factor relative to the data.
This is only used if the resolution is given as a LSF file.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.add_fine_lines">
<code class="descname">add_fine_lines</code><span class="sig-paren">(</span><em>line_tag</em>, <em>levels=None</em>, <em>full_label=False</em>, <em>velspan=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_fine_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.add_fine_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Add fine-structure line complexes by providing only the main transition.
This function is mainly useful for the CI complexes, where the many
lines are closely located and often blended.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Line tag for the ground state transition, e.g., “CI_1656”</p>
</dd>
<dt><strong>levels</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, list(str)    [default = None]</span></dt>
<dd><p class="first last">The levels of the fine-structure complexes to add, starting with “a”
referring to the first excited level, “b” is the second, etc..
Several levels can be given at once: [‘a’, ‘b’].
Note that the ground state transition is always included.
If <cite>levels</cite> is not given, all levels are included.</p>
</dd>
<dt><strong>full_label</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If <cite>True</cite>, the label will be translated to the full quantum
mechanical description of the state.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.add_line">
<code class="descname">add_line</code><span class="sig-paren">(</span><em>line_tag</em>, <em>velspan=None</em>, <em>active=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.add_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an absorption line to the DataSet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The line tag for the transition which should be defined.
Ex: “FeII_2374”</p>
</dd>
<dt><strong>velspan</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = None]</span></dt>
<dd><p class="first last">The velocity span around the line center, which will be included
in the fit. If <cite>None</cite> is given, use the default <cite>self.velspan</cite>
defined (default = 500 km/s).</p>
</dd>
<dt><strong>active</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">Set the <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> as active
(i.e., included in the fit).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This will initiate a <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> class
with the atomic data for the transition, as well as creating a
fitting <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a> containing the data cutout
around the line center.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.add_lines">
<code class="descname">add_lines</code><span class="sig-paren">(</span><em>line_tags</em>, <em>velspan=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.add_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <cite>self.add_many_lines</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.add_many_lines">
<code class="descname">add_many_lines</code><span class="sig-paren">(</span><em>tags</em>, <em>velspan=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_many_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.add_many_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Add many lines at once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>tags</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(str)</span></dt>
<dd><p class="first last">A list of line tags for the transitions that should be added.</p>
</dd>
<dt><strong>velspan</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = None]</span></dt>
<dd><p class="first last">The velocity span around the line center, which will be included
in the fit. If <cite>None</cite> is given, use the default
<code class="xref py py-attr docutils literal notranslate"><span class="pre">velspan</span></code> defined (500 km/s).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.add_molecule">
<code class="descname">add_molecule</code><span class="sig-paren">(</span><em>molecule</em>, <em>band</em>, <em>Jmax=0</em>, <em>velspan=None</em>, <em>full_label=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.add_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add molecular lines for a given band, e.g., “AX(0-0)” of CO.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>molecule</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The molecular identifier, e.g., ‘CO’, ‘H2’</p>
</dd>
<dt><strong>band</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The vibrational band of the molecule, e.g., for CO: “AX(0-0)”
These bands are defined in <code class="xref py py-mod docutils literal notranslate"><span class="pre">molecules</span></code>.</p>
</dd>
<dt><strong>Jmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int   [default = 0]</span></dt>
<dd><p class="first last">The maximal rotational level to include. All levels up to and including <cite>J</cite>
will be included.</p>
</dd>
<dt><strong>velspan</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = None]</span></dt>
<dd><p class="first last">The velocity span around the line center, which will be included in the fit.
If <cite>None</cite> is given, use the default <code class="xref py py-attr docutils literal notranslate"><span class="pre">velspan</span></code>
defined (500 km/s).</p>
</dd>
<dt><strong>full_label</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If <cite>True</cite>, the label will be translated to the full quantum
mechanical description of the state.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.add_spectrum">
<code class="descname">add_spectrum</code><span class="sig-paren">(</span><em>filename</em>, <em>res</em>, <em>normalized=False</em>, <em>mask=None</em>, <em>continuum=None</em>, <em>nsub=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.add_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Add spectral data from ASCII file (three or four columns accepted).
This is a wrapper of the method <cite>add_data</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Filename of the ASCII spectrum containing at least 3 columns:
(wavelength, flux, error). A fourth column may be included
containing a spectral mask.</p>
</dd>
<dt><strong>res</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or string</span></dt>
<dd><p class="first last">Spectral resolution either given in km/s  (c/R),
which is assumed to be constant over the whole spectrum,
or as a string referring to a file containing the detailed
line-spread function for the given spectrum.
See details in the documentation.</p>
</dd>
<dt><strong>normalized</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If the input spectrum is normalized this should be given as True
in order to skip normalization steps.</p>
</dd>
<dt><strong>mask</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array, shape (n)</span></dt>
<dd><p class="first last">Boolean/int array defining the fitting regions.
Only pixels with mask=True/1 will be included in the fit.</p>
</dd>
<dt><strong>continuum</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array, shape (n)</span></dt>
<dd><p class="first last">Continuum spectrum. The input spectrum will be normalized using
this continuum spectrum.</p>
</dd>
<dt><strong>nsub</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">Kernel subsampling factor relative to the data.
This is only used if the resolution is given as a LSF file.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.all_active_lines">
<code class="descname">all_active_lines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.all_active_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.all_active_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all the active lines defined by their <cite>line_tag</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.clear_mask">
<code class="descname">clear_mask</code><span class="sig-paren">(</span><em>line_tag</em>, <em>idx=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.clear_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.clear_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the mask for the <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a>
containing the given <cite>line_tag</cite>.
If more regions are defined for the same line (when fitting multiple spectra),
the given region can be specified by passing an index <cite>idx</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.copy_components">
<code class="descname">copy_components</code><span class="sig-paren">(</span><em>to_ion=''</em>, <em>from_ion=''</em>, <em>logN=0</em>, <em>ref_comp=None</em>, <em>tie_z=True</em>, <em>tie_b=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.copy_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.copy_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy velocity structure to <cite>ion</cite> from another <cite>ion</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>to_ion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The new ion to define.</p>
</dd>
<dt><strong>from_ion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The base ion which will be used as reference.</p>
</dd>
<dt><strong>logN</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">If logN is given, the starting guess is defined from this value
following the pattern of the components defined for <cite>anchor</cite> relative to the
<cite>ref_comp</cite> (default: the first component).</p>
</dd>
<dt><strong>ref_comp</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The reference component to which logN will be scaled.</p>
</dd>
<dt><strong>tie_z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If <cite>True</cite>, the redshifts for all components of the two ions will be tied together.</p>
</dd>
<dt><strong>tie_b</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If <cite>True</cite>, the b-parameters for all components of the two ions will be tied together.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.deactivate_all">
<code class="descname">deactivate_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.deactivate_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.deactivate_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Deactivate all lines defined in the DataSet. This will not remove the lines.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.deactivate_fine_lines">
<code class="descname">deactivate_fine_lines</code><span class="sig-paren">(</span><em>line_tag</em>, <em>levels=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.deactivate_fine_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.deactivate_fine_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Deactivate all lines associated to a given fine-structure complex.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The line tag of the ground state transition to deactivate.</p>
</dd>
<dt><strong>levels</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, list(str)   [default = None]</span></dt>
<dd><p class="first last">The levels of the fine-structure complexes to deactivate,
with the string “a” referring to the first excited level,
“b” is the second, etc…
Several levels can be given at once as a list: [‘a’, ‘b’]
or as a concatenated string: ‘abc’.
By default, all levels are included.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.deactivate_line">
<code class="descname">deactivate_line</code><span class="sig-paren">(</span><em>line_tag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.deactivate_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.deactivate_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Deactivate a given line defined by its <cite>line_tag</cite>.
This will exclude the line during the fit but will not remove the data.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.deactivate_molecule">
<code class="descname">deactivate_molecule</code><span class="sig-paren">(</span><em>molecule</em>, <em>band</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.deactivate_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.deactivate_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Deactivate all lines for the given band of the given molecule.
To see the available molecular bands defined, see the manual pdf
or <code class="xref py py-mod docutils literal notranslate"><span class="pre">VoigtFit.molecules</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.delete_component">
<code class="descname">delete_component</code><span class="sig-paren">(</span><em>ion</em>, <em>index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.delete_component"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.delete_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove component of the given <cite>ion</cite> with the given <cite>index</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.find_ion">
<code class="descname">find_ion</code><span class="sig-paren">(</span><em>ion</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.find_ion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.find_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all line tags for a given ion.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.find_line">
<code class="descname">find_line</code><span class="sig-paren">(</span><em>line_tag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.find_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.find_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up the fitting <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a> for a given <em>line tag</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The line tag of the line whose region will be returned.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>regions_of_line</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a></span></dt>
<dd><p class="first last">A list of the fitting regions containing the given line.
This can be more than one region in case of overlapping or multiple spectra.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>verbose=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the absorption lines using chi-square minimization.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>verbose</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">This will print the fit results to terminal.</p>
</dd>
<dt><strong>plot</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">This will make the best-fit solution show up in a new window.</p>
</dd>
<dt><strong>**kwargs</strong></dt>
<dd><p class="first last">Keyword arguments are derived from the <a href="#id4"><span class="problematic" id="id5">`scipy.optimize`_</span></a> minimization methods.
The default method is <a href="#id6"><span class="problematic" id="id7">leastsq_</span></a>, used in <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a>.
This can be changed using the <cite>method</cite> keyword.
See documentation in <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a> and <a href="#id8"><span class="problematic" id="id9">scipy.optimize_</span></a>.</p>
</dd>
<dt><strong>rebin</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int   [default = 1]</span></dt>
<dd><p class="first last">Rebin data by a factor <em>rebin</em> before fitting.
Passed as part of <cite>kwargs</cite>.</p>
</dd>
<dt><strong>sampling</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int  [default = 3]</span></dt>
<dd><p class="first last">Subsampling factor for the evaluation of the line profile.
This is only used if the kernel is constant in velocity
along the spectrum.
Passed as part of <cite>kwargs</cite>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>popt</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a href="#id10"><span class="problematic" id="id11">lmfit.MinimizerResult_</span></a></span></dt>
<dd><p class="first last">The minimzer results from <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a> containing best-fit parameters
and fit details, e.g., exit status and reduced chi squared.
See documentation for <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a>.</p>
</dd>
<dt><strong>chi2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The chi squared value of the best-fit. Note that this value is <strong>not</strong>
the reduced chi squared. This value, and the number of degrees of freedom,
are available under the <cite>popt</cite> object.</p>
</dd>
<dt><strong>.. _scipy.optimize: https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html</strong></dt>
<dd></dd>
<dt><strong>.. _leastsq: https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html</strong></dt>
<dd></dd>
<dt><strong>.. _lmfit.MinimizerResult: https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.MinimizerResult</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.fix_structure">
<code class="descname">fix_structure</code><span class="sig-paren">(</span><em>ion=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.fix_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.fix_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix the velocity structure, that is, the redshifts and the b-parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = None]</span></dt>
<dd><p class="first last">The ion for which the structure should be fixed.
If <cite>None</cite> is given, the structure is fixed for all ions.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.free_structure">
<code class="descname">free_structure</code><span class="sig-paren">(</span><em>ion=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.free_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.free_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Free the velocity structure, that is, the redshifts and the b-parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = None]</span></dt>
<dd><p class="first last">The ion for which the structure should be released.
If <cite>None</cite> is given, the structure is released for all ions.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.get_lines_for_ion">
<code class="descname">get_lines_for_ion</code><span class="sig-paren">(</span><em>ion</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.get_lines_for_ion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.get_lines_for_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> objects
corresponding to the given <em>ion</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>ion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The ion for the lines to get.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lines_for_ion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code>)</span></dt>
<dd><p class="first last">List of Lines defined for the given <em>ion</em>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.get_name">
<code class="descname">get_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.get_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.get_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the DataSet.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.get_resolution">
<code class="descname">get_resolution</code><span class="sig-paren">(</span><em>line_tag</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.get_resolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.get_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the spectral resolution for the fitting <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a>
where the line with the given <cite>line_tag</cite> is defined.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The line-tag for the line to look up: e.g., “FeII_2374”</p>
</dd>
<dt><strong>verbose</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If <cite>True</cite>, print the returned spectral resolution to std out.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>resolutions</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float</span></dt>
<dd><p class="first last">A list of the spectral resolution of the fitting regions
where the given line is defined.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.has_ion">
<code class="descname">has_ion</code><span class="sig-paren">(</span><em>ion</em>, <em>active_only=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.has_ion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.has_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the dataset has lines defined for the given ion.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.has_line">
<code class="descname">has_line</code><span class="sig-paren">(</span><em>line_tag</em>, <em>active_only=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.has_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.has_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the given line is defined.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.interactive_components">
<code class="descname">interactive_components</code><span class="sig-paren">(</span><em>line_tag</em>, <em>velocity=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.interactive_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.interactive_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Define components interactively for a given ion. The components will be defined on the
basis of the given line for that ion. If the line is defined in several spectra
then the interactive window will show up for each.
Running the interactive mode more times for different transitions of the same ion
will append the components to the structure.
If no components should be added, then simply click <cite>enter</cite> to terminate the process
for the given transition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Line tag for the line belonging to the ion for which components should be defined.</p>
</dd>
<dt><strong>velocity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If a <cite>True</cite>, the region is displayed in velocity space
relative to the systemic redshift instead of in wavelength space.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This will launch an interactive plot showing the fitting region of the given line.
The user can then click on the positions of the components which. At the end, the
redshifts and estimated column densities are printed to terminal. The b-parameter
is assumed to be unresolved, i.e., taken from the resolution.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.load_components_from_file">
<code class="descname">load_components_from_file</code><span class="sig-paren">(</span><em>fname</em>, <em>fit_pars=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.load_components_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.load_components_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load best-fit parameters from an output file <cite>fname</cite>.
If <cite>fit_pars</cite> is True, then update the best_fit parameters.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.mask_line">
<code class="descname">mask_line</code><span class="sig-paren">(</span><em>line_tag</em>, <em>reset=True</em>, <em>mask=None</em>, <em>telluric=True</em>, <em>velocity=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.mask_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.mask_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Define exclusion masks for the fitting region of a given line.
Note that the masked regions are exclusion regions and will not be used for the fit.
If components have been defined, these will be shown as vertical lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Line tag for the <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> whose
<a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a> should be masked.</p>
</dd>
<dt><strong>reset</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If <cite>True</cite>, clear the mask before defining a new mask.</p>
</dd>
<dt><strong>mask</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (n)   [default = None]</span></dt>
<dd><p class="first last">If the mask is given, it must be a boolean array of the same length
as the region flux, err, and wl arrays.
Passing a mask this was supresses the interactive masking process.</p>
</dd>
<dt><strong>telluric</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If <cite>True</cite>, a telluric absorption template and sky emission template
is shown for reference.</p>
</dd>
<dt><strong>velocity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If a <cite>True</cite>, the regions are displayed in velocity space
relative to the systemic redshift instead of in wavelength space
when masking and defining continuum normalization interactively.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.mask_range">
<code class="descname">mask_range</code><span class="sig-paren">(</span><em>line_tag</em>, <em>x1</em>, <em>x2</em>, <em>idx=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.mask_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.mask_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Define mask in a range from <cite>x1</cite> to <cite>x2</cite> in velocity space.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.normalize_line">
<code class="descname">normalize_line</code><span class="sig-paren">(</span><em>line_tag</em>, <em>norm_method='spline'</em>, <em>velocity=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.normalize_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.normalize_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize or re-normalize a given line</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Line tag of the line whose fitting region should be normalized.</p>
</dd>
<dt><strong>norm_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = ‘spline’]</span></dt>
<dd><p class="first last">Normalization method used for the interactive continuum fit.
Should be on of: [“spline”, “linear”]</p>
</dd>
<dt><strong>velocity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If a <cite>True</cite>, the regions are displayed in velocity space
relative to the systemic redshift instead of in wavelength space
when masking and defining continuum normalization interactively.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.plot_fit">
<code class="descname">plot_fit</code><span class="sig-paren">(</span><em>rebin=1</em>, <em>fontsize=12</em>, <em>xmin=None</em>, <em>xmax=None</em>, <em>max_rows=4</em>, <em>ymin=None</em>, <em>ymax=None</em>, <em>filename=None</em>, <em>subsample_profile=1</em>, <em>npad=50</em>, <em>loc='left'</em>, <em>highlight_props=None</em>, <em>residuals=True</em>, <em>norm_resid=False</em>, <em>default_props={}</em>, <em>element_props={}</em>, <em>legend=True</em>, <em>label_all_ions=False</em>, <em>xunit='vel'</em>, <em>line_props=None</em>, <em>hl_line_props=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.plot_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <em>all</em> the absorption lines and the best-fit profiles.
For details, see <code class="xref py py-func docutils literal notranslate"><span class="pre">VoigtFit.output.plot_all_lines()</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.plot_line">
<code class="descname">plot_line</code><span class="sig-paren">(</span><em>line_tag</em>, <em>index=0</em>, <em>plot_fit=False</em>, <em>loc='left'</em>, <em>rebin=1</em>, <em>nolabels=False</em>, <em>axis=None</em>, <em>fontsize=12</em>, <em>xmin=None</em>, <em>xmax=None</em>, <em>ymin=None</em>, <em>ymax=None</em>, <em>show=True</em>, <em>subsample_profile=1</em>, <em>npad=50</em>, <em>residuals=True</em>, <em>norm_resid=False</em>, <em>legend=True</em>, <em>default_props={}</em>, <em>element_props={}</em>, <em>highlight_props=None</em>, <em>label_all_ions=False</em>, <em>xunit='velocity'</em>, <em>line_props=None</em>, <em>hl_line_props=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.plot_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.plot_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a single fitting <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a>
containing the line corresponding to the given <cite>line_tag</cite>.
For details, see <code class="xref py py-func docutils literal notranslate"><span class="pre">output.plot_single_line()</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.prepare_dataset">
<code class="descname">prepare_dataset</code><span class="sig-paren">(</span><em>norm=True</em>, <em>mask=False</em>, <em>verbose=True</em>, <em>active_only=False</em>, <em>force_clean=True</em>, <em>velocity=False</em>, <em>check_lines=True</em>, <em>f_lower=0.0</em>, <em>f_upper=100.0</em>, <em>l_lower=0.0</em>, <em>l_upper=10000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.prepare_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.prepare_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the data for fitting. This function sets up the parameter structure,
and handles the normalization and masking of fitting regions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>norm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">Opens an interactive window to let the user normalize each region
using the defined <code class="xref py py-attr docutils literal notranslate"><span class="pre">norm_method</span></code>.</p>
</dd>
<dt><strong>mask</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">Opens an interactive window to let the user mask each fitting region.</p>
</dd>
<dt><strong>verbose</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If this is set, the code will print small info statements during the run.</p>
</dd>
<dt><strong>force_clean</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If this is True, components for inactive elements will be removed.</p>
</dd>
<dt><strong>velocity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">If <cite>True</cite>, the regions are displayed in velocity space
relative to the systemic redshift instead of in wavelength space
when masking and defining continuum normalization interactively.</p>
</dd>
<dt><strong>check_lines</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If <cite>True</cite>, all available lines covered by the data will be checked.
The user will be propmted if lines are available for ions that have
already been defined.</p>
</dd>
<dt><strong>f_lower</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = 0.]</span></dt>
<dd><p class="first last">Lower limit on oscillator strengths for transitions when verifying
all transitions for defined ions.</p>
</dd>
<dt><strong>f_upper</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = 100.]</span></dt>
<dd><p class="first last">Upper limit on oscillator strengths for transitions when verifying
all transitions for defined ions.</p>
</dd>
<dt><strong>l_lower</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = 0.]</span></dt>
<dd><p class="first last">Lower limit on rest-frame wavelength for transitions when verifying
all transitions for defined ions.</p>
</dd>
<dt><strong>l_upper</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = 1.e4]</span></dt>
<dd><p class="first last">Upper limit on rest-frame wavelength for transitions when verifying
all transitions for defined ions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>bool</strong></dt>
<dd><p class="first last">The function returns <cite>True</cite> when the dataset has passed all the steps.
If one step fails, the function returns <cite>False</cite>.
The <code class="xref py py-attr docutils literal notranslate"><span class="pre">ready2fit</span></code> attribute of the dataset is also
updated accordingly.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.print_cont_parameters">
<code class="descname">print_cont_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.print_cont_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.print_cont_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Print Chebyshev coefficients for the continuum fit.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.print_metallicity">
<code class="descname">print_metallicity</code><span class="sig-paren">(</span><em>logNHI</em>, <em>err=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.print_metallicity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.print_metallicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the total column densities for each element relative to
HI in Solar units.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.print_results">
<code class="descname">print_results</code><span class="sig-paren">(</span><em>velocity=True</em>, <em>elements='all'</em>, <em>systemic=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.print_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the best fit parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>velocity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">If <cite>True</cite>, show the relative velocities of each component instead of redshifts.</p>
</dd>
<dt><strong>elements</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(str)   [default = ‘all’]</span></dt>
<dd><p class="first last">A list of elements for which to show parameters.</p>
</dd>
<dt><strong>systemic</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = None]</span></dt>
<dd><p class="first last">The systemic redshift used as reference for the relative velocities.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.print_total">
<code class="descname">print_total</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.print_total"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.print_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the total column densities of all components.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.remove_fine_lines">
<code class="descname">remove_fine_lines</code><span class="sig-paren">(</span><em>line_tag</em>, <em>levels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.remove_fine_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.remove_fine_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove lines associated to a given fine-structure complex.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The line tag of the ground state transition to remove.</p>
</dd>
<dt><strong>levels</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, list(str)   [default = None]</span></dt>
<dd><p class="first last">The levels of the fine-structure complexes to remove, with “a” referring
to the first excited level, “b” is the second, etc..
Several levels can be given at once as a list: [‘a’, ‘b’]
or as a concatenated string: ‘abc’.
By default, all levels are included.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.remove_line">
<code class="descname">remove_line</code><span class="sig-paren">(</span><em>line_tag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.remove_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.remove_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an absorption line from the DataSet. If this is the last line
in a fitting region the given region will be eliminated, and if this
is the last line of a given ion, then the components will be eliminated
for that ion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line_tag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Line tag of the transition that should be removed.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.remove_molecule">
<code class="descname">remove_molecule</code><span class="sig-paren">(</span><em>molecule</em>, <em>band</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.remove_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.remove_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all lines for the given band of the given molecule.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.reset_all_regions">
<code class="descname">reset_all_regions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.reset_all_regions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.reset_all_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the data in all <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Regions</span></code></a>
defined in the DataSet to use the raw input data.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.reset_components">
<code class="descname">reset_components</code><span class="sig-paren">(</span><em>ion=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.reset_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.reset_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset component structure for a given ion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ion</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = None]</span></dt>
<dd><p class="first last">The ion for which to reset the components: e.g., ‘FeII’, ‘HI’, ‘CIa’, etc.
If <a href="#id2"><span class="problematic" id="id3">`</span></a>None`is given, <em>all</em> components for <em>all</em> ions will be reset.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.reset_region">
<code class="descname">reset_region</code><span class="sig-paren">(</span><em>reg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.reset_region"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.reset_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the data in a given <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">regions.Region</span></code></a> to use the raw input data.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the DataSet to file using the HDF5 format.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.save_cont_parameters_to_file">
<code class="descname">save_cont_parameters_to_file</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.save_cont_parameters_to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.save_cont_parameters_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the best-fit continuum parameters to ASCII table output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = None]</span></dt>
<dd><p class="first last">If <cite>None</cite>, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> attribute will be used.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.save_fit_regions">
<code class="descname">save_fit_regions</code><span class="sig-paren">(</span><em>filename=None</em>, <em>individual=False</em>, <em>path=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.save_fit_regions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.save_fit_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the fitting regions to ASCII table output.
The format is as follows:
(wavelength , normalized flux , normalized error , best-fit profile , mask)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = None]</span></dt>
<dd><p class="first last">Filename for the fitting regions.
If <cite>None</cite>, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> attribute will be used.</p>
</dd>
<dt><strong>individual</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = False]</span></dt>
<dd><p class="first last">Save the fitting regions to individual files.
By default all regions are concatenated into one file.</p>
</dd>
<dt><strong>path</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str   [default = ‘’]</span></dt>
<dd><p class="first">Specify a path to prepend to the filename in order to save output to a given
directory or path. Can be given both as relative or absolute path.
If the path doesn’t end in <cite>/</cite> it will be appended automatically.
The final filename will be:</p>
<blockquote class="last">
<div><p><cite>path/</cite> + <cite>filename</cite> [+ <cite>_regN</cite>] + <cite>.reg</cite></p>
</div></blockquote>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.save_parameters">
<code class="descname">save_parameters</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.save_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.save_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the best-fit parameters to ASCII table output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Filename for the fit parameter file.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.set_name">
<code class="descname">set_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.set_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.set_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of the DataSet. This parameter is used when saving the dataset.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.set_resolution">
<code class="descname">set_resolution</code><span class="sig-paren">(</span><em>res</em>, <em>line_tag=None</em>, <em>verbose=True</em>, <em>nsub=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.set_resolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.set_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the spectral resolution in km/s for the <a class="reference internal" href="#regions.Region" title="regions.Region"><code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></a>
containing the line with the given <cite>line_tag</cite>. If multiple spectra are fitted
simultaneously, this method will set the same resolution for <em>all</em> spectra.
If <cite>line_tag</cite> is not given, the resolution will be set for <em>all</em> regions,
including the raw data chunks defined in <code class="xref py py-attr docutils literal notranslate"><span class="pre">VoigtFit.DataSet.data</span></code>!</p>
<p>Note – If not all data chunks have the same resolution, this method
should be used with caution. It is advised to check the spectral resolution beforehand
and only update the appropriate regions using a for-loop.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.set_systemic_redshift">
<code class="descname">set_systemic_redshift</code><span class="sig-paren">(</span><em>z_sys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.set_systemic_redshift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.set_systemic_redshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the systemic redshift of the dataset</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.show_components">
<code class="descname">show_components</code><span class="sig-paren">(</span><em>ion=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.show_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.show_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the defined components for a given <cite>ion</cite>.
By default, all ions are shown.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.show_lines">
<code class="descname">show_lines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.show_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.show_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Print all defined lines to terminal.
The output shows whether the line is active or not
and the number of components for the given ion.</p>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.sum_components">
<code class="descname">sum_components</code><span class="sig-paren">(</span><em>ions</em>, <em>components=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.sum_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.sum_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the total column density for the given <cite>components</cite>
of the given <cite>ion</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>ions</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str or list(str)</span></dt>
<dd><p class="first last">List of ions or a single ion for which to calculate the total
column density.</p>
</dd>
<dt><strong>components</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(int)</span></dt>
<dd><p class="first last">List of integers corresponding to the indeces of the components
to sum over.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>total_logN</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict()</span></dt>
<dd><p class="first last">Dictionary containing the log of total column density for each ion.</p>
</dd>
<dt><strong>total_logN_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict()</span></dt>
<dd><p class="first last">Dictionary containing the error on the log of total column density
for each ion.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="VoigtFit.DataSet.velocity_plot">
<code class="descname">velocity_plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.velocity_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VoigtFit.DataSet.velocity_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a velocity plot, showing all the fitting regions defined, in order to compare
different lines and to identify blends and contamination.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="class-component">
<h2>class <strong>Component</strong><a class="headerlink" href="#class-component" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="components.Component">
<em class="property">class </em><code class="descclassname">components.</code><code class="descname">Component</code><span class="sig-paren">(</span><em>z</em>, <em>b</em>, <em>logN</em>, <em>var_z=True</em>, <em>var_b=True</em>, <em>var_N=True</em>, <em>tie_z=None</em>, <em>tie_b=None</em>, <em>tie_N=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#components.Component" title="Permalink to this definition">¶</a></dt>
<dd><p>Component object which contains the parameters for each velocity component
of an absorption profile: redshift, z; broadning parameter, b; and column density
in log(cm^-2).
Options can control whether the components parameters are variable during the fit
or whether they are tied to another parameter using the <cite>var_</cite> and <cite>tie_</cite> options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>b</strong></dt>
<dd></dd>
<dt><strong>logN</strong></dt>
<dd></dd>
<dt><strong>tie_N</strong></dt>
<dd></dd>
<dt><strong>tie_b</strong></dt>
<dd></dd>
<dt><strong>tie_z</strong></dt>
<dd></dd>
<dt><strong>var_N</strong></dt>
<dd></dd>
<dt><strong>var_b</strong></dt>
<dd></dd>
<dt><strong>var_z</strong></dt>
<dd></dd>
<dt><strong>z</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#components.Component.get_option" title="components.Component.get_option"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_option</span></code></a>(key)</td>
<td>Return the <cite>value</cite> for the given option, key must be either <cite>tie_</cite> or <cite>var_</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#components.Component.get_pars" title="components.Component.get_pars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pars</span></code></a>()</td>
<td>Unpack the physical parameters [z, b, logN]</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#components.Component.set_option" title="components.Component.set_option"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_option</span></code></a>(key,&nbsp;value)</td>
<td>Set the <cite>value</cite> for a given option, must be either <cite>tie_</cite> or <cite>var_</cite>.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="components.Component.get_option">
<code class="descname">get_option</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component.get_option"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#components.Component.get_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <cite>value</cite> for the given option, key must be either <cite>tie_</cite> or <cite>var_</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="components.Component.get_pars">
<code class="descname">get_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component.get_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#components.Component.get_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack the physical parameters [z, b, logN]</p>
</dd></dl>

<dl class="method">
<dt id="components.Component.set_option">
<code class="descname">set_option</code><span class="sig-paren">(</span><em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component.set_option"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#components.Component.set_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <cite>value</cite> for a given option, must be either <cite>tie_</cite> or <cite>var_</cite>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="class-line">
<h2>class <strong>Line</strong><a class="headerlink" href="#class-line" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="lines.Line">
<em class="property">class </em><code class="descclassname">lines.</code><code class="descname">Line</code><span class="sig-paren">(</span><em>tag</em>, <em>active=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lines.Line" title="Permalink to this definition">¶</a></dt>
<dd><p>Line object containing atomic data for the given transition.
Only the line_tag is passed, the rest of the information is
looked up in the atomic database.</p>
<p class="rubric">Attributes</p>
<dl class="docutils">
<dt>tag <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>The line tag for the line, e.g., “FeII_2374”</dd>
<dt>ion <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>The ion for the line; The ion for “FeII_2374” is “FeII”.</dd>
<dt>element <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Equal to <code class="docutils literal notranslate"><span class="pre">ion</span></code> for backwards compatibility.</dd>
<dt>l0 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Rest-frame resonant wavelength of the transition.
Unit: Angstrom.</dd>
<dt>f <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The oscillator strength for the transition.</dd>
<dt>gam <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The radiation damping constant or Einstein coefficient.</dd>
<dt>mass <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The atomic mass in atomic mass units.</dd>
<dt>active <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd>The state of the line in the dataset. Only active lines will
be included in the fit.</dd>
</dl>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#lines.Line.get_properties" title="lines.Line.get_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_properties</span></code></a>()</td>
<td>Return the principal atomic constants for the transition: <em>l0</em>, <em>f</em>, and <em>gam</em>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#lines.Line.set_active" title="lines.Line.set_active"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_active</span></code></a>()</td>
<td>Set the line active; include the line in the fit.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#lines.Line.set_inactive" title="lines.Line.set_inactive"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_inactive</span></code></a>()</td>
<td>Set the line inactive; exclude the line in the fit.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="lines.Line.get_properties">
<code class="descname">get_properties</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line.get_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lines.Line.get_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the principal atomic constants for the transition: <em>l0</em>, <em>f</em>, and <em>gam</em>.</p>
</dd></dl>

<dl class="method">
<dt id="lines.Line.set_active">
<code class="descname">set_active</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line.set_active"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lines.Line.set_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the line active; include the line in the fit.</p>
</dd></dl>

<dl class="method">
<dt id="lines.Line.set_inactive">
<code class="descname">set_inactive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line.set_inactive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lines.Line.set_inactive" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the line inactive; exclude the line in the fit.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="class-region">
<h2>class <strong>Region</strong><a class="headerlink" href="#class-region" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="regions.Region">
<em class="property">class </em><code class="descclassname">regions.</code><code class="descname">Region</code><span class="sig-paren">(</span><em>velspan</em>, <em>specID</em>, <em>line=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region" title="Permalink to this definition">¶</a></dt>
<dd><p>A Region contains the fitting data, exclusion mask and line information.
The class is instantiated with the velocity span, <cite>velspan</cite>, and a spectral ID
pointing to the raw data chunk from <cite>DataSet.data</cite>,
and can include a <code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code> instance for the first line
belonging to the region.</p>
<p class="rubric">Attributes</p>
<dl class="docutils">
<dt>velspan <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The velocity range to used for the fitting region.</dd>
<dt>lines <span class="classifier-delimiter">:</span> <span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code>)</span></dt>
<dd>A list of Lines defined in the region.</dd>
<dt>label <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>A LaTeX label describing the lines in the region for plotting purposes.</dd>
<dt>res <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Spectral resolution of the region in km/s.</dd>
<dt>wl <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd>Data array of wavelengths in Ångstrøm.</dd>
<dt>flux <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd>Data array of fluxes (normalized if <code class="xref py py-attr docutils literal notranslate"><span class="pre">normalized</span></code> is <cite>True</cite>).</dd>
<dt>err <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd>Array of uncertainties for each flux element.</dd>
<dt>normalized <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><cite>True</cite> if the data in the region are normlized.</dd>
<dt>mask <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd>Exclusion mask for the region:
0/<cite>False</cite> = pixel is <em>not</em> included in the fit.
1/<cite>True</cite> = pixel is included in the fit.</dd>
<dt>new_mask <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd>Internal parameter for <a class="reference internal" href="#VoigtFit.DataSet.prepare_dataset" title="VoigtFit.DataSet.prepare_dataset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">VoigtFit.DataSet.prepare_dataset()</span></code></a>.
If <cite>True</cite>, an interactive masking process will be initiated in the
preparation stage.</dd>
<dt>cont_err <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>An estimate of the uncertainty in the continuum fit.</dd>
<dt>specID <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>A spectral identifier to point back to the raw data chunk.</dd>
</dl>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#regions.Region.add_data_to_region" title="regions.Region.add_data_to_region"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data_to_region</span></code></a>(data_chunk,&nbsp;cutout)</td>
<td>Define the spectral data for the fitting region.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#regions.Region.add_line" title="regions.Region.add_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_line</span></code></a>(line)</td>
<td>Add a new <code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code> to the fitting region.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#regions.Region.clear_mask" title="regions.Region.clear_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_mask</span></code></a>()</td>
<td>Clear the already defined mask in the region.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#regions.Region.define_mask" title="regions.Region.define_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">define_mask</span></code></a>([z,&nbsp;dataset,&nbsp;telluric,&nbsp;z_sys])</td>
<td>Use an interactive window to define the mask for the region.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#regions.Region.generate_label" title="regions.Region.generate_label"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_label</span></code></a>([active_only,&nbsp;ignore_finelines])</td>
<td>Automatically generate a descriptive label for the region.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#regions.Region.has_active_lines" title="regions.Region.has_active_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_active_lines</span></code></a>()</td>
<td>Return <cite>True</cite> is at least one line in the region is active.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#regions.Region.has_line" title="regions.Region.has_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_line</span></code></a>(line_tag)</td>
<td>Return <cite>True</cite> if a line with the given <cite>line_tag</cite> is defined in the region.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#regions.Region.is_normalized" title="regions.Region.is_normalized"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_normalized</span></code></a>()</td>
<td>Return <cite>True</cite> if the region data is normalized.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#regions.Region.normalize" title="regions.Region.normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize</span></code></a>([plot,&nbsp;norm_method,&nbsp;z_sys])</td>
<td>Normalize the region if the data are not already normalized.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#regions.Region.remove_line" title="regions.Region.remove_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_line</span></code></a>(line_tag)</td>
<td>Remove absorption line with the given <cite>line_tag</cite> from the region.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#regions.Region.set_label" title="regions.Region.set_label"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_label</span></code></a>(text)</td>
<td>Set descriptive text label for the given region.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#regions.Region.unpack" title="regions.Region.unpack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unpack</span></code></a>()</td>
<td>Return the data of the region (wl, flux, error, mask)</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="55%" />
<col width="45%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>set_mask</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="regions.Region.add_data_to_region">
<code class="descname">add_data_to_region</code><span class="sig-paren">(</span><em>data_chunk</em>, <em>cutout</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.add_data_to_region"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.add_data_to_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the spectral data for the fitting region.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>data_chunk</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict()</span></dt>
<dd><p class="first last">A <cite>data_chunk</cite> as defined in the data structure of <a class="reference internal" href="#VoigtFit.DataSet.add_data" title="VoigtFit.DataSet.add_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.data</span></code></a>.</p>
</dd>
<dt><strong>cutout</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool array</span></dt>
<dd><p class="first last">A boolean array defining the subset of the <cite>data_chunk</cite> which makes up the fitting region.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="regions.Region.add_line">
<code class="descname">add_line</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.add_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.add_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code> to the fitting region.</p>
</dd></dl>

<dl class="method">
<dt id="regions.Region.clear_mask">
<code class="descname">clear_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.clear_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.clear_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the already defined mask in the region.</p>
</dd></dl>

<dl class="method">
<dt id="regions.Region.define_mask">
<code class="descname">define_mask</code><span class="sig-paren">(</span><em>z=None</em>, <em>dataset=None</em>, <em>telluric=True</em>, <em>z_sys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.define_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.define_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Use an interactive window to define the mask for the region.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = None]</span></dt>
<dd><p class="first last">If a redshift is given, the lines in the region are shown as vertical lines
at the given redshift.</p>
</dd>
<dt><strong>dataset</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#VoigtFit.DataSet" title="VoigtFit.DataSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code></a>   [default = None]</span></dt>
<dd><p class="first last">A dataset with components defined for the lines in the region.
If a dataset is passed, the components of the lines in the region are shown.</p>
</dd>
<dt><strong>telluric</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool   [default = True]</span></dt>
<dd><p class="first last">Show telluric absorption and sky emission line templates during the masking.</p>
</dd>
<dt><strong>z_sys</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float   [default = None]</span></dt>
<dd><p class="first last">If a systemic redshift is given, the region is displayed in velocity space
relative to the given systemic redshift instead of in wavelength space.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="regions.Region.generate_label">
<code class="descname">generate_label</code><span class="sig-paren">(</span><em>active_only=True</em>, <em>ignore_finelines=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.generate_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.generate_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically generate a descriptive label for the region.</p>
</dd></dl>

<dl class="method">
<dt id="regions.Region.has_active_lines">
<code class="descname">has_active_lines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.has_active_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.has_active_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <cite>True</cite> is at least one line in the region is active.</p>
</dd></dl>

<dl class="method">
<dt id="regions.Region.has_line">
<code class="descname">has_line</code><span class="sig-paren">(</span><em>line_tag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.has_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.has_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <cite>True</cite> if a line with the given <cite>line_tag</cite> is defined in the region.</p>
</dd></dl>

<dl class="method">
<dt id="regions.Region.is_normalized">
<code class="descname">is_normalized</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.is_normalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.is_normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <cite>True</cite> if the region data is normalized.</p>
</dd></dl>

<dl class="method">
<dt id="regions.Region.normalize">
<code class="descname">normalize</code><span class="sig-paren">(</span><em>plot=True</em>, <em>norm_method='linear'</em>, <em>z_sys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the region if the data are not already normalized.
Choose from two methods:</p>
<blockquote>
<div><dl class="docutils">
<dt>1:  define left and right continuum regions</dt>
<dd>and fit a linear continuum.</dd>
<dt>2:  define the continuum as a range of points</dt>
<dd>and use spline interpolation to infer the
continuum.</dd>
</dl>
</div></blockquote>
<p>If <cite>z_sys</cite> is not <cite>None</cite>, show the region in velocity space using
instead of wavelength space.</p>
</dd></dl>

<dl class="method">
<dt id="regions.Region.remove_line">
<code class="descname">remove_line</code><span class="sig-paren">(</span><em>line_tag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.remove_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.remove_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove absorption line with the given <cite>line_tag</cite> from the region.</p>
</dd></dl>

<dl class="method">
<dt id="regions.Region.set_label">
<code class="descname">set_label</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.set_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.set_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Set descriptive text label for the given region.</p>
</dd></dl>

<dl class="method">
<dt id="regions.Region.unpack">
<code class="descname">unpack</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/regions.html#Region.unpack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#regions.Region.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the data of the region (wl, flux, error, mask)</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-voigt">
<span id="module-voigt"></span><h2>module <strong>voigt</strong><a class="headerlink" href="#module-voigt" title="Permalink to this headline">¶</a></h2>
<p>The module contains functions to evaluate the optical depth,
to convert this to observed transmission and to convolve the
observed spectrum with the instrumental profile.</p>
<dl class="function">
<dt id="voigt.H">
<code class="descclassname">voigt.</code><code class="descname">H</code><span class="sig-paren">(</span><em>a</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#H"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#voigt.H" title="Permalink to this definition">¶</a></dt>
<dd><p>Voigt Profile Approximation from T. Tepper-Garcia 2006, 2007.</p>
</dd></dl>

<dl class="function">
<dt id="voigt.Voigt">
<code class="descclassname">voigt.</code><code class="descname">Voigt</code><span class="sig-paren">(</span><em>wl</em>, <em>l0</em>, <em>f</em>, <em>N</em>, <em>b</em>, <em>gam</em>, <em>z=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#Voigt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#voigt.Voigt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the optical depth Voigt profile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>wl</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd><p class="first last">Wavelength grid in Angstroms at which to evaluate the optical depth.</p>
</dd>
<dt><strong>l0</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Rest frame transition wavelength in Angstroms.</p>
</dd>
<dt><strong>f</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Oscillator strength.</p>
</dd>
<dt><strong>N</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Column density in units of cm^-2.</p>
</dd>
<dt><strong>b</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Velocity width of the Voigt profile in cm/s.</p>
</dd>
<dt><strong>gam</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Radiation damping constant, or Einstein constant (A_ul)</p>
</dd>
<dt><strong>z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The redshift of the observed wavelength grid <cite>l</cite>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>tau</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd><p class="first last">Optical depth array evaluated at the input grid wavelengths <cite>l</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="voigt.convolve_numba">
<code class="descclassname">voigt.</code><code class="descname">convolve_numba</code><a class="reference internal" href="_modules/voigt.html#convolve_numba"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#voigt.convolve_numba" title="Permalink to this definition">¶</a></dt>
<dd><p>Define convolution function for a wavelength dependent kernel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>P</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd><p class="first last">Intrinsic line profile.</p>
</dd>
<dt><strong>kernel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array, shape (N, M)</span></dt>
<dd><p class="first last">Each row of the <cite>kernel</cite> corresponds to the wavelength dependent
line-spread function (LSF) evaluated at each pixel of the input
profile <cite>P</cite>. Each LSF must be normalized!</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>P_con</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array, shape (N)</span></dt>
<dd><p class="first last">Resulting profile after performing convolution with <cite>kernel</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function is decorated by the <cite>jit</cite> decorator from <a href="#id12"><span class="problematic" id="id13">`numba`_</span></a> in order
to speed up the calculation.</p>
</dd></dl>

<dl class="function">
<dt id="voigt.evaluate_continuum">
<code class="descclassname">voigt.</code><code class="descname">evaluate_continuum</code><span class="sig-paren">(</span><em>x</em>, <em>pars</em>, <em>reg_num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#evaluate_continuum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#voigt.evaluate_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the continuum model using Chebyshev polynomials.
All regions are fitted with the same order of polynomials.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd><p class="first last">Input wavelength grid in Ångstrøm.</p>
</dd>
<dt><strong>pars</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict(<a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a>)</span></dt>
<dd><p class="first last">An instance of <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a> containing the Chebyshev
coefficients for each region.</p>
</dd>
<dt><strong>reg_num</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The region number, i.e., the index of the region in the list
<code class="xref py py-attr docutils literal notranslate"><span class="pre">VoigtFit.DataSet.regions</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>cont_model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd><p class="first last">The continuum Chebyshev polynomial evaluated at the input wavelengths <cite>x</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="voigt.evaluate_profile">
<code class="descclassname">voigt.</code><code class="descname">evaluate_profile</code><span class="sig-paren">(</span><em>x</em>, <em>pars</em>, <em>z_sys</em>, <em>lines</em>, <em>components</em>, <em>kernel</em>, <em>sampling=3</em>, <em>kernel_nsub=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#evaluate_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#voigt.evaluate_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the observed Voigt profile. The calculated optical depth, <cite>tau</cite>,
is converted to observed transmission, <cite>f</cite>:</p>
<div class="math notranslate nohighlight">
\[f = e^{-\tau}\]</div>
<p>The observed transmission is subsequently convolved with the instrumental
broadening profile assumed to be Gaussian with a full-width at half maximum
of res. The resolving power is assumed to be constant in velocity space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd><p class="first last">Wavelength array in Ångstrøm on which to evaluate the profile.</p>
</dd>
<dt><strong>pars</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict(<a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a>)</span></dt>
<dd><p class="first last">An instance of <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a> containing the line parameters.</p>
</dd>
<dt><strong>lines</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code>)</span></dt>
<dd><p class="first last">List of lines to evaluate. Should be a list of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> objects.</p>
</dd>
<dt><strong>components</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">Dictionary containing component data for the defined ions.
See <code class="xref py py-attr docutils literal notranslate"><span class="pre">VoigtFit.DataSet.components</span></code>.</p>
</dd>
<dt><strong>kernel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array, shape (N, M)  or float</span></dt>
<dd><p class="first last">The convolution kernel for each wavelength pixel.
If an array is given, each row of the array must specify
the line-spread function (LSF) at the given wavelength pixel.
The LSF must be normalized!
If a float is given, the resolution FWHM is given in km/s (c/R).
In this case the spectral resolution is assumed
to be constant in velocity space.</p>
</dd>
<dt><strong>sampling</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer  [default = 3]</span></dt>
<dd><p class="first last">The subsampling factor used for defining the input logarithmically
space wavelength grid. The number of pixels in the evaluation will
be sampling * N, where N is the number of input pixels.
The final profile will be interpolated back onto the original
wavelength grid defined by <cite>x</cite>.</p>
</dd>
<dt><strong>kernel_nsub</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">Kernel subsampling factor relative to the data.
This is only used if the resolution is given as a LSF file.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>profile_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape (N)</span></dt>
<dd><p class="first last">Observed line profile convolved with the instrument profile.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-output">
<h2>module <strong>output</strong><a class="headerlink" href="#module-output" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">VoigtFit Parameter Language</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">VoigtFit Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#class-dataset">class <strong>DataSet</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-component">class <strong>Component</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-line">class <strong>Line</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-region">class <strong>Region</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-voigt">module <strong>voigt</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-output">module <strong>output</strong></a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="physical_model_results.html">Results of Physical Model</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Jens-Kristian Krogager.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.8</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>