
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>VoigtFit Interface &#8212; VoigtFit 0.13.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Results of Physical Model" href="physical_model_results.html" />
    <link rel="prev" title="VoigtFit Parameter Language" href="documentation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <pre class="logo literal-block">____  _           _________________________________________
    \/ \  _/\    /
        \/   \  / oigtFit
              \/</pre>
<section id="voigtfit-interface">
<h1>VoigtFit Interface<a class="headerlink" href="#voigtfit-interface" title="Permalink to this headline">¶</a></h1>
<section id="class-dataset">
<h2>class <strong>DataSet</strong><a class="headerlink" href="#class-dataset" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">VoigtFit.dataset.</span></span><span class="sig-name descname"><span class="pre">DataSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Main class of the package <code class="docutils literal notranslate"><span class="pre">VoigtFit</span></code>. The DataSet handles all the major parts of the fit.
Spectral data must be added using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_data</span></code> method.
Hereafter the absorption lines to be fitted are added to the DataSet using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">add_line</span></code> or
<code class="xref py py-meth docutils literal notranslate"><span class="pre">add_many_lines</span></code> methods.
Lastly, the components of each element is defined using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">add_component</span></code> method.
When all lines and components have been defined, the DataSet must be prepared by
calling the <code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_dataset</span></code>
method and subsequently, the lines can be fitted using
the <code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p class="rubric">Attributes</p>
<dl>
<dt>redshift<span class="classifier">float</span></dt><dd><p>Systemic redshift of the absorption system.</p>
</dd>
<dt>name<span class="classifier">str   [default = ‘’]</span></dt><dd><p>The name of the DataSet, this will be used for saving the dataset to a file structure.</p>
</dd>
<dt>verbose<span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>False</cite>, the printed information statements will be suppressed.</p>
</dd>
<dt>data<span class="classifier">list(data_chunks)</span></dt><dd><p>A list of <em>data chunks</em> defined for the dataset. A <em>data chunk</em> is
a dictionary with keys ‘wl’, ‘flux’, ‘error’, ‘res’, ‘norm’.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.add_data</span></code>.</p>
</dd>
<dt>lines<span class="classifier">dict</span></dt><dd><p>A dictionary holding pairs of defined (<em>line_tag</em> : <code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code>)</p>
</dd>
<dt>all_lines<span class="classifier">list(str)</span></dt><dd><p>A list of all the defined <em>line tags</em> for easy look-up.</p>
</dd>
<dt>molecules<span class="classifier">dict</span></dt><dd><p>A dictionary holding a list of the defined molecular bands and Jmax
for each molecule:
<code class="docutils literal notranslate"><span class="pre">{molecule*</span> <span class="pre">:</span> <span class="pre">[[band1,</span> <span class="pre">Jmax1], [band2,</span> <span class="pre">Jmax2],</span> <span class="pre">etc...]}</span></code></p>
</dd>
<dt>regions<span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">regions.Region</span></code>)</span></dt><dd><p>A list of the fitting regions.</p>
</dd>
<dt>cheb_order<span class="classifier">int   [default = -1]</span></dt><dd><p>The maximum order of Chebyshev polynomials to use for the continuum
fitting in each region. If negative, the Chebyshev polynomials will
not be included in the fit.</p>
</dd>
<dt>norm_method<span class="classifier">str   [default = ‘linear’]</span></dt><dd><p>Default normalization method to use for interactive normalization
if Chebyshev polynomial fitting should not be used.</p>
</dd>
<dt>components<span class="classifier">dict</span></dt><dd><p>A dictionary of components for each <em>ion</em> defined:
(<em>ion</em> : [z, b, logN, options]). See <code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.add_component</span></code>.</p>
</dd>
<dt>velspan<span class="classifier">float   [default = 500]</span></dt><dd><p>The default velocity range to use for the definition
of fitting regions.</p>
</dd>
<dt>ready2fit<span class="classifier">bool   [default = False]</span></dt><dd><p>This attribute is checked before fitting the dataset. Only when
the attribute has been set to <cite>True</cite> can the dataset be fitted.
This will be toggled after a successful run of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.prepare_dataset</span></code>.</p>
</dd>
<dt>best_fit<span class="classifier"><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a>   [default = None]</span></dt><dd><p>Best-fit parameters from <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a>.
This attribute will be <cite>None</cite> until the dataset has been fitted.</p>
</dd>
<dt>pars<span class="classifier"><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a>   [default = None]</span></dt><dd><p>Placeholder for the fit parameters initiated before the fit.
The parameters will be defined during the call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.prepare_dataset</span></code> based on the defined components.</p>
</dd>
<dt>static_variables<span class="classifier"><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a></span></dt><dd><p>Parameter dictionary that holds fit variables other than those related to
components of absorption lines and continuum parameters.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.activate_all" title="VoigtFit.dataset.DataSet.activate_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activate_all</span></code></a>()</p></td>
<td><p>Activate all lines defined in the DataSet.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.activate_fine_lines" title="VoigtFit.dataset.DataSet.activate_fine_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activate_fine_lines</span></code></a>(line_tag[, levels])</p></td>
<td><p>Activate all lines associated to a given fine-structure complex.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.activate_line" title="VoigtFit.dataset.DataSet.activate_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activate_line</span></code></a>(line_tag)</p></td>
<td><p>Activate a given line defined by its <cite>line_tag</cite></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.activate_molecule" title="VoigtFit.dataset.DataSet.activate_molecule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activate_molecule</span></code></a>(molecule, band)</p></td>
<td><p>Activate all lines for the given band of the given molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.add_component" title="VoigtFit.dataset.DataSet.add_component"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_component</span></code></a>(ion, z, b, logN[, var_z, …])</p></td>
<td><p>Add component for a given ion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.add_component_velocity" title="VoigtFit.dataset.DataSet.add_component_velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_component_velocity</span></code></a>(ion, v, b, logN[, …])</p></td>
<td><p>Same as for <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_component</span></code> but input is given as relative velocity instead of redshift.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.add_data" title="VoigtFit.dataset.DataSet.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(wl, flux, res[, err, normalized, …])</p></td>
<td><p>Add spectral data to the DataSet.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.add_fine_lines" title="VoigtFit.dataset.DataSet.add_fine_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fine_lines</span></code></a>(line_tag[, levels, …])</p></td>
<td><p>Add fine-structure line complexes by providing only the main transition.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.add_line" title="VoigtFit.dataset.DataSet.add_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_line</span></code></a>(line_tag[, velspan, active])</p></td>
<td><p>Add an absorption line to the DataSet.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.add_lines" title="VoigtFit.dataset.DataSet.add_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_lines</span></code></a>(line_tags[, velspan])</p></td>
<td><p>Alias for <cite>self.add_many_lines</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.add_many_lines" title="VoigtFit.dataset.DataSet.add_many_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_many_lines</span></code></a>(tags[, velspan])</p></td>
<td><p>Add many lines at once.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.add_molecule" title="VoigtFit.dataset.DataSet.add_molecule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_molecule</span></code></a>(molecule, band[, Jmax, …])</p></td>
<td><p>Add molecular lines for a given band, e.g., “AX(0-0)” of CO.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.add_spectrum" title="VoigtFit.dataset.DataSet.add_spectrum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_spectrum</span></code></a>(filename, res[, airORvac, …])</p></td>
<td><p>Add spectral data from ASCII file (three or four columns accepted).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.all_active_lines" title="VoigtFit.dataset.DataSet.all_active_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_active_lines</span></code></a>()</p></td>
<td><p>Returns a list of all the active lines defined by their <cite>line_tag</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.clear_mask" title="VoigtFit.dataset.DataSet.clear_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_mask</span></code></a>(line_tag[, idx])</p></td>
<td><p>Clear the mask for the <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code> containing the given <cite>line_tag</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.copy_components" title="VoigtFit.dataset.DataSet.copy_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_components</span></code></a>([to_ion, from_ion, logN, …])</p></td>
<td><p>Copy velocity structure to <cite>ion</cite> from another <cite>ion</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.deactivate_all" title="VoigtFit.dataset.DataSet.deactivate_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deactivate_all</span></code></a>()</p></td>
<td><p>Deactivate all lines defined in the DataSet.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.deactivate_fine_lines" title="VoigtFit.dataset.DataSet.deactivate_fine_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deactivate_fine_lines</span></code></a>(line_tag[, levels, …])</p></td>
<td><p>Deactivate all lines associated to a given fine-structure complex.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.deactivate_line" title="VoigtFit.dataset.DataSet.deactivate_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deactivate_line</span></code></a>(line_tag)</p></td>
<td><p>Deactivate a given line defined by its <cite>line_tag</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.deactivate_molecule" title="VoigtFit.dataset.DataSet.deactivate_molecule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deactivate_molecule</span></code></a>(molecule, band)</p></td>
<td><p>Deactivate all lines for the given band of the given molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.delete_component" title="VoigtFit.dataset.DataSet.delete_component"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_component</span></code></a>(ion, index)</p></td>
<td><p>Remove component of the given <cite>ion</cite> with the given <cite>index</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.equivalent_width_limit" title="VoigtFit.dataset.DataSet.equivalent_width_limit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equivalent_width_limit</span></code></a>(line_tag[, ref, …])</p></td>
<td><p>Determine the equivalent width limit and corresponding limit on log(N).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.find_ion" title="VoigtFit.dataset.DataSet.find_ion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_ion</span></code></a>(ion)</p></td>
<td><p>Return a list of all line tags for a given ion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.find_line" title="VoigtFit.dataset.DataSet.find_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_line</span></code></a>(line_tag)</p></td>
<td><p>Look up the fitting <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code> for a given <em>line tag</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.fit" title="VoigtFit.dataset.DataSet.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>([verbose])</p></td>
<td><p>Fit the absorption lines using chi-square minimization.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.fix_structure" title="VoigtFit.dataset.DataSet.fix_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_structure</span></code></a>([ion])</p></td>
<td><p>Fix the velocity structure, that is, the redshifts and the b-parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.free_structure" title="VoigtFit.dataset.DataSet.free_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">free_structure</span></code></a>([ion])</p></td>
<td><p>Free the velocity structure, that is, the redshifts and the b-parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.get_lines_for_ion" title="VoigtFit.dataset.DataSet.get_lines_for_ion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lines_for_ion</span></code></a>(ion)</p></td>
<td><p>Return a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> objects corresponding to the given <em>ion</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.get_name" title="VoigtFit.dataset.DataSet.get_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_name</span></code></a>()</p></td>
<td><p>Returns the name of the DataSet.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.get_resolution" title="VoigtFit.dataset.DataSet.get_resolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolution</span></code></a>(line_tag[, verbose])</p></td>
<td><p>Return the spectral resolution for the fitting <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code> where the line with the given <cite>line_tag</cite> is defined.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.has_ion" title="VoigtFit.dataset.DataSet.has_ion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_ion</span></code></a>(ion[, active_only])</p></td>
<td><p>Return True if the dataset has lines defined for the given ion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.has_line" title="VoigtFit.dataset.DataSet.has_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_line</span></code></a>(line_tag[, active_only])</p></td>
<td><p>Return True if the given line is defined.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.interactive_components" title="VoigtFit.dataset.DataSet.interactive_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interactive_components</span></code></a>(line_tag[, velocity])</p></td>
<td><p>Define components interactively for a given ion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.load_components_from_file" title="VoigtFit.dataset.DataSet.load_components_from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_components_from_file</span></code></a>(fname[, fit_pars])</p></td>
<td><p>Load best-fit parameters from an output file <cite>fname</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.mask_line" title="VoigtFit.dataset.DataSet.mask_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_line</span></code></a>(line_tag[, reset, mask, telluric, …])</p></td>
<td><p>Define exclusion masks for the fitting region of a given line.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.mask_range" title="VoigtFit.dataset.DataSet.mask_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_range</span></code></a>(line_tag, x1, x2[, idx])</p></td>
<td><p>Define mask in a range from <cite>x1</cite> to <cite>x2</cite> in velocity space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.normalize_line" title="VoigtFit.dataset.DataSet.normalize_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize_line</span></code></a>(line_tag[, norm_method, velocity])</p></td>
<td><p>Normalize or re-normalize a given line</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.plot_fit" title="VoigtFit.dataset.DataSet.plot_fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_fit</span></code></a>([rebin, fontsize, xmin, xmax, …])</p></td>
<td><p>Plot <em>all</em> the absorption lines and the best-fit profiles.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.plot_line" title="VoigtFit.dataset.DataSet.plot_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_line</span></code></a>(line_tag[, index, plot_fit, loc, …])</p></td>
<td><p>Plot a single fitting <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code> containing the line corresponding to the given <cite>line_tag</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.prepare_dataset" title="VoigtFit.dataset.DataSet.prepare_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_dataset</span></code></a>([norm, mask, verbose, …])</p></td>
<td><p>Prepare the data for fitting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.print_cont_parameters" title="VoigtFit.dataset.DataSet.print_cont_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_cont_parameters</span></code></a>()</p></td>
<td><p>Print Chebyshev coefficients for the continuum fit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.print_metallicity" title="VoigtFit.dataset.DataSet.print_metallicity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_metallicity</span></code></a>(logNHI[, err])</p></td>
<td><p>Print the total column densities for each element relative to HI in Solar units.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.print_results" title="VoigtFit.dataset.DataSet.print_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_results</span></code></a>([velocity, elements, systemic])</p></td>
<td><p>Print the best fit parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.print_total" title="VoigtFit.dataset.DataSet.print_total"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_total</span></code></a>()</p></td>
<td><p>Print the total column densities of all components.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.remove_fine_lines" title="VoigtFit.dataset.DataSet.remove_fine_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_fine_lines</span></code></a>(line_tag[, levels])</p></td>
<td><p>Remove lines associated to a given fine-structure complex.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.remove_line" title="VoigtFit.dataset.DataSet.remove_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_line</span></code></a>(line_tag)</p></td>
<td><p>Remove an absorption line from the DataSet.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.remove_molecule" title="VoigtFit.dataset.DataSet.remove_molecule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_molecule</span></code></a>(molecule, band)</p></td>
<td><p>Remove all lines for the given band of the given molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.reset_all_regions" title="VoigtFit.dataset.DataSet.reset_all_regions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_all_regions</span></code></a>([active_only])</p></td>
<td><p>Reset the data in all <code class="xref py py-class docutils literal notranslate"><span class="pre">Regions</span></code> defined in the DataSet to use the raw input data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.reset_components" title="VoigtFit.dataset.DataSet.reset_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_components</span></code></a>([ion])</p></td>
<td><p>Reset component structure for a given ion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.reset_region" title="VoigtFit.dataset.DataSet.reset_region"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_region</span></code></a>(reg)</p></td>
<td><p>Reset the data in a given <code class="xref py py-class docutils literal notranslate"><span class="pre">regions.Region</span></code> to use the raw input data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.save" title="VoigtFit.dataset.DataSet.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>([filename, verbose])</p></td>
<td><p>Save the DataSet to file using the HDF5 format.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.save_cont_parameters_to_file" title="VoigtFit.dataset.DataSet.save_cont_parameters_to_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_cont_parameters_to_file</span></code></a>(filename)</p></td>
<td><p>Save the best-fit continuum parameters to ASCII table output.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.save_fit_regions" title="VoigtFit.dataset.DataSet.save_fit_regions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_fit_regions</span></code></a>([filename, individual, path])</p></td>
<td><p>Save the fitting regions to ASCII table output.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.save_parameters" title="VoigtFit.dataset.DataSet.save_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_parameters</span></code></a>(filename)</p></td>
<td><p>Save the best-fit parameters to ASCII table output.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.set_name" title="VoigtFit.dataset.DataSet.set_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_name</span></code></a>(name)</p></td>
<td><p>Set the name of the DataSet.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.set_resolution" title="VoigtFit.dataset.DataSet.set_resolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_resolution</span></code></a>(res[, line_tag, verbose, nsub])</p></td>
<td><p>Set the spectral resolution in km/s for the <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code> containing the line with the given <cite>line_tag</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.set_systemic_redshift" title="VoigtFit.dataset.DataSet.set_systemic_redshift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_systemic_redshift</span></code></a>(z_sys)</p></td>
<td><p>Update the systemic redshift of the dataset</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.show_components" title="VoigtFit.dataset.DataSet.show_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">show_components</span></code></a>([ion])</p></td>
<td><p>Show the defined components for a given <cite>ion</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.show_lines" title="VoigtFit.dataset.DataSet.show_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">show_lines</span></code></a>()</p></td>
<td><p>Print all defined lines to terminal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.sum_components" title="VoigtFit.dataset.DataSet.sum_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum_components</span></code></a>(ions[, components])</p></td>
<td><p>Calculate the total column density for the given <cite>components</cite> of the given <cite>ion</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.dataset.DataSet.velocity_plot" title="VoigtFit.dataset.DataSet.velocity_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity_plot</span></code></a>(**kwargs)</p></td>
<td><p>Create a velocity plot, showing all the fitting regions defined, in order to compare different lines and to identify blends and contamination.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 72%" />
<col style="width: 28%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>add_variable</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_NHI</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>remove_all_lines</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>reset_static_variables</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.activate_all">
<span class="sig-name descname"><span class="pre">activate_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.activate_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.activate_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Activate all lines defined in the DataSet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.activate_fine_lines">
<span class="sig-name descname"><span class="pre">activate_fine_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.activate_fine_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.activate_fine_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Activate all lines associated to a given fine-structure complex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>The line tag of the ground state transition to activate.</p>
</dd>
<dt><strong>levels</strong><span class="classifier">str, list(str)   [default = None]</span></dt><dd><p>The levels of the fine-structure complexes to activate,
with the string “a” referring to the first excited level,
“b” is the second, etc…
Several levels can be given at once as a list: [‘a’, ‘b’]
or as a concatenated string: ‘abc’.
By default, all levels are included.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.activate_line">
<span class="sig-name descname"><span class="pre">activate_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.activate_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.activate_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Activate a given line defined by its <cite>line_tag</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.activate_molecule">
<span class="sig-name descname"><span class="pre">activate_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.activate_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.activate_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Activate all lines for the given band of the given molecule.</p>
<blockquote>
<div><ul class="simple">
<li><p>Ex: <code class="docutils literal notranslate"><span class="pre">activate_molecule('CO',</span> <span class="pre">'AX(0-0)')</span></code></p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.add_component">
<span class="sig-name descname"><span class="pre">add_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.add_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Add component for a given ion. Each component defined will be used for all transitions
defined for a given ion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ion</strong><span class="classifier">str</span></dt><dd><p>The ion for which to define a component: e.g., “FeII”, “HI”, “CIa”, etc.</p>
</dd>
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>The redshift of the component.</p>
</dd>
<dt><strong>b</strong><span class="classifier">float</span></dt><dd><p>The effective broadening parameter for the component in km/s.
This parameter is constrained to be in the interval [0 - 1000] km/s.</p>
</dd>
<dt><strong>logN</strong><span class="classifier">float</span></dt><dd><p>The 10-base logarithm of the column density of the component.
The column density is expected in cm^-2.</p>
</dd>
<dt><strong>var_z</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>False</cite>, the redshift of the component will be kept fixed.</p>
</dd>
<dt><strong>var_b</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>False</cite>, the b-parameter of the component will be kept fixed.</p>
</dd>
<dt><strong>var_N</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>False</cite>, the column density of the component will be kept fixed.</p>
</dd>
<dt><strong>tie_z, tie_b, tie_N</strong><span class="classifier">str   [default = None]</span></dt><dd><p>Parameter constraints for the different variables.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The ties are defined relative to the parameter names. The naming is as follows:
The redshift of the first component of FeII is called “z0_FeII”,
the logN of the second component of SiII is called “logN1_SiII”.
For more information about parameter ties, see the documentation for <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.add_component_velocity">
<span class="sig-name descname"><span class="pre">add_component_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_component_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.add_component_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as for <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_component</span></code>
but input is given as relative velocity instead of redshift.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.add_data">
<span class="sig-name descname"><span class="pre">add_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Add spectral data to the DataSet. This will be used to define fitting regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>wl</strong><span class="classifier">ndarray, shape (n)</span></dt><dd><p>Input vacuum wavelength array in Ångstrøm.</p>
</dd>
<dt><strong>flux</strong><span class="classifier">ndarray, shape (n)</span></dt><dd><p>Input flux array, should be same length as wl</p>
</dd>
<dt><strong>res</strong><span class="classifier">float or string</span></dt><dd><p>Spectral resolution either given in km/s  (c/R),
which is assumed to be constant over the whole spectrum,
or as a string referring to a file containing the detailed
line-spread function for the given spectrum.
See details in the data section of the <a class="reference internal" href="documentation.html#documentation"><span class="std std-ref">VoigtFit Parameter Language</span></a>.</p>
</dd>
<dt><strong>err</strong><span class="classifier">ndarray, shape (n)   [default = None]</span></dt><dd><p>Error array, should be same length as wl
If <cite>None</cite> is given, an uncertainty of 1 is given to all pixels.</p>
</dd>
<dt><strong>normalized</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If the input spectrum is normalized this should be given as True
in order to skip normalization steps.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">array, shape (n)</span></dt><dd><p>Boolean/int array defining the fitting regions.
Only pixels with mask=True/1 will be included in the fit.</p>
</dd>
<dt><strong>nsub</strong><span class="classifier">integer</span></dt><dd><p>Kernel subsampling factor relative to the data.
This is only used if the resolution is given as a LSF file.</p>
</dd>
<dt><strong>filename</strong><span class="classifier">string</span></dt><dd><p>The filename from which the data originated. Optional but highly recommended.
Alternatively, use the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.add_spectrum</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.add_fine_lines">
<span class="sig-name descname"><span class="pre">add_fine_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velspan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_fine_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.add_fine_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Add fine-structure line complexes by providing only the main transition.
This function is mainly useful for the CI complexes, where the many
lines are closely located and often blended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>Line tag for the ground state transition, e.g., “CI_1656”</p>
</dd>
<dt><strong>levels</strong><span class="classifier">str, list(str)    [default = None]</span></dt><dd><p>The levels of the fine-structure complexes to add, starting with “a”
referring to the first excited level, “b” is the second, etc..
Several levels can be given at once: [‘a’, ‘b’].
Note that the ground state transition is always included.
If <cite>levels</cite> is not given, all levels are included.</p>
</dd>
<dt><strong>full_label</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If <cite>True</cite>, the label will be translated to the full quantum
mechanical description of the state.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.add_line">
<span class="sig-name descname"><span class="pre">add_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velspan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.add_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an absorption line to the DataSet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>The line tag for the transition which should be defined.
Ex: “FeII_2374”</p>
</dd>
<dt><strong>velspan</strong><span class="classifier">float   [default = None]</span></dt><dd><p>The velocity span around the line center, which will be included
in the fit. If <cite>None</cite> is given, use the default <cite>self.velspan</cite>
defined (default = 500 km/s).</p>
</dd>
<dt><strong>active</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>Set the <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> as active
(i.e., included in the fit).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This will initiate a <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> class
with the atomic data for the transition, as well as creating a
fitting <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code> containing the data cutout
around the line center.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.add_lines">
<span class="sig-name descname"><span class="pre">add_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velspan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.add_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <cite>self.add_many_lines</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.add_many_lines">
<span class="sig-name descname"><span class="pre">add_many_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velspan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_many_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.add_many_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Add many lines at once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tags</strong><span class="classifier">list(str)</span></dt><dd><p>A list of line tags for the transitions that should be added.</p>
</dd>
<dt><strong>velspan</strong><span class="classifier">float   [default = None]</span></dt><dd><p>The velocity span around the line center, which will be included
in the fit. If <cite>None</cite> is given, use the default
<code class="xref py py-attr docutils literal notranslate"><span class="pre">velspan</span></code> defined (500 km/s).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.add_molecule">
<span class="sig-name descname"><span class="pre">add_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Jmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velspan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.add_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add molecular lines for a given band, e.g., “AX(0-0)” of CO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">str</span></dt><dd><p>The molecular identifier, e.g., ‘CO’, ‘H2’</p>
</dd>
<dt><strong>band</strong><span class="classifier">str</span></dt><dd><p>The vibrational band of the molecule, e.g., for CO: “AX(0-0)”
These bands are defined in <code class="xref py py-mod docutils literal notranslate"><span class="pre">molecules</span></code>.</p>
</dd>
<dt><strong>Jmax</strong><span class="classifier">int   [default = 0]</span></dt><dd><p>The maximal rotational level to include. All levels up to and including <cite>J</cite>
will be included.</p>
</dd>
<dt><strong>velspan</strong><span class="classifier">float   [default = None]</span></dt><dd><p>The velocity span around the line center, which will be included in the fit.
If <cite>None</cite> is given, use the default <code class="xref py py-attr docutils literal notranslate"><span class="pre">velspan</span></code>
defined (500 km/s).</p>
</dd>
<dt><strong>full_label</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If <cite>True</cite>, the label will be translated to the full quantum
mechanical description of the state.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.add_spectrum">
<span class="sig-name descname"><span class="pre">add_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">airORvac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vac'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.add_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.add_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Add spectral data from ASCII file (three or four columns accepted).
This is a wrapper of the method <cite>add_data</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>filename</strong><span class="classifier">string</span></dt><dd><p>Filename of the ASCII spectrum containing at least 3 columns:
(wavelength, flux, error). A fourth column may be included
containing a spectral mask.</p>
</dd>
<dt><strong>res</strong><span class="classifier">float or string</span></dt><dd><p>Spectral resolution either given in km/s  (c/R),
which is assumed to be constant over the whole spectrum,
or as a string referring to a file containing the detailed
line-spread function for the given spectrum.
See details in the documentation.</p>
</dd>
<dt><strong>airORvac</strong><span class="classifier">string  {‘vac’ or ‘air’}</span></dt><dd><p>Defines whether the input wavelengths are in ‘air’ or ‘vacuum’ units. If given as ‘air’
the wavelengths will be converted to ‘vacuum’.</p>
</dd>
<dt><strong>normalized</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If the input spectrum is normalized this should be given as True
in order to skip normalization steps.</p>
</dd>
<dt><strong>mask_array</strong><span class="classifier">array, shape (n)</span></dt><dd><p>Boolean/int array defining the fitting regions.
Only pixels with mask=True/1 will be included in the fit.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">Deprecated, use <cite>mask_array</cite></span></dt><dd></dd>
<dt><strong>use_mask</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If False, do not pass the mask array to the dataset. This may be useful if the mask defined in the spectrum
is not appropriate for the fitting purposes.</p>
</dd>
<dt><strong>continuum</strong><span class="classifier">array, shape (n)</span></dt><dd><p>Continuum spectrum. The input spectrum will be normalized using
this continuum spectrum.</p>
</dd>
<dt><strong>nsub</strong><span class="classifier">integer   [default = 1]</span></dt><dd><p>Kernel subsampling factor relative to the data.
This is only used if the resolution is given as a LSF file.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>Print status messages.</p>
</dd>
<dt><strong>ext</strong><span class="classifier">int or string</span></dt><dd><p>Index or name of the extension in the HDU List. Only used if the input is a FITS file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.all_active_lines">
<span class="sig-name descname"><span class="pre">all_active_lines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.all_active_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.all_active_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all the active lines defined by their <cite>line_tag</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.clear_mask">
<span class="sig-name descname"><span class="pre">clear_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.clear_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.clear_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the mask for the <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code>
containing the given <cite>line_tag</cite>.
If more regions are defined for the same line (when fitting multiple spectra),
the given region can be specified by passing an index <cite>idx</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.copy_components">
<span class="sig-name descname"><span class="pre">copy_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_ion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_ion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.copy_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.copy_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy velocity structure to <cite>ion</cite> from another <cite>ion</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>to_ion</strong><span class="classifier">str</span></dt><dd><p>The new ion to define.</p>
</dd>
<dt><strong>from_ion</strong><span class="classifier">str</span></dt><dd><p>The base ion which will be used as reference.</p>
</dd>
<dt><strong>logN</strong><span class="classifier">float</span></dt><dd><p>If logN is given, the starting guess is defined from this value
following the pattern of the components defined for <cite>anchor</cite> relative to the
<cite>ref_comp</cite> (default: the first component).</p>
</dd>
<dt><strong>ref_comp</strong><span class="classifier">int</span></dt><dd><p>The reference component to which logN will be scaled.</p>
</dd>
<dt><strong>tie_z</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>True</cite>, the redshifts for all components of the two ions will be tied together.</p>
</dd>
<dt><strong>tie_b</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>True</cite>, the b-parameters for all components of the two ions will be tied together.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.deactivate_all">
<span class="sig-name descname"><span class="pre">deactivate_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.deactivate_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.deactivate_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Deactivate all lines defined in the DataSet. This will not remove the lines.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.deactivate_fine_lines">
<span class="sig-name descname"><span class="pre">deactivate_fine_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.deactivate_fine_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.deactivate_fine_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Deactivate all lines associated to a given fine-structure complex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>The line tag of the ground state transition to deactivate.</p>
</dd>
<dt><strong>levels</strong><span class="classifier">str, list(str)   [default = None]</span></dt><dd><p>The levels of the fine-structure complexes to deactivate,
with the string “a” referring to the first excited level,
“b” is the second, etc…
Several levels can be given at once as a list: [‘a’, ‘b’]
or as a concatenated string: ‘abc’.
By default, all levels are included.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.deactivate_line">
<span class="sig-name descname"><span class="pre">deactivate_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.deactivate_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.deactivate_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Deactivate a given line defined by its <cite>line_tag</cite>.
This will exclude the line during the fit but will not remove the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.deactivate_molecule">
<span class="sig-name descname"><span class="pre">deactivate_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.deactivate_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.deactivate_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Deactivate all lines for the given band of the given molecule.
To see the available molecular bands defined, see the manual pdf
or <code class="xref py py-mod docutils literal notranslate"><span class="pre">VoigtFit.molecules</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.delete_component">
<span class="sig-name descname"><span class="pre">delete_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.delete_component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.delete_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove component of the given <cite>ion</cite> with the given <cite>index</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.equivalent_width_limit">
<span class="sig-name descname"><span class="pre">equivalent_width_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nofit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.equivalent_width_limit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.equivalent_width_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the equivalent width limit and corresponding limit on log(N).</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>The line ID of the absorption line for which the limit should be estimated.
(Must be a line in the line-list of VoigtFit. Ex.: FeII_1611, TiII_1910, etc.)</p>
</dd>
<dt><strong>ref</strong><span class="classifier">str or <cite>None</cite></span></dt><dd><p>The reference line used to determine the integration range in velocity space,
which contains 99.7% of the optical depth. By default, the strongest line of
the same ionization state (e.g., I, II, IV, etc.) in the dataset is used.
If the reference line has been fitted, the best-fit optical depth profile
will be used, otherwise the range is determined by the observed apparent
optical depth.</p>
</dd>
<dt><strong>nofit</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If True, always use the observed apparent optical depth of the reference line
(<cite>ref</cite>, see above).</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float   [default = 3]</span></dt><dd><p>The significance level of the inferred upper limit, by default 3 sigma (99.7%) is used.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>Print informative messages from the function?</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">float   [default = 15]</span></dt><dd><p>The continuum noise threshold used to infer the edge of the apparent optical depth
of the observed profile. The noise is estimated as the median noise per pixel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.find_ion">
<span class="sig-name descname"><span class="pre">find_ion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.find_ion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.find_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all line tags for a given ion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.find_line">
<span class="sig-name descname"><span class="pre">find_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.find_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.find_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up the fitting <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code> for a given <em>line tag</em>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>The line tag of the line whose region will be returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>regions_of_line</strong><span class="classifier">list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code></span></dt><dd><p>A list of the fitting regions containing the given line.
This can be more than one region in case of overlapping or multiple spectra.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the absorption lines using chi-square minimization.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>verbose</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>This will print the fit results to terminal.</p>
</dd>
<dt><strong>plot</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>This will make the best-fit solution show up in a new window.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments are derived from the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html..">scipy.optimize</a> minimization methods.
The default method is <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html..">leastsq</a>, used in <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a>.
This can be changed using the <cite>method</cite> keyword.
See documentation in <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a> and <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html..">scipy.optimize</a>.</p>
</dd>
<dt><strong>rebin</strong><span class="classifier">int   [default = 1]</span></dt><dd><p>Rebin data by a factor <em>rebin</em> before fitting.
Passed as part of <cite>kwargs</cite>.</p>
</dd>
<dt><strong>sampling</strong><span class="classifier">int  [default = 3]</span></dt><dd><p>Subsampling factor for the evaluation of the line profile.
This is only used if the kernel is constant in velocity
along the spectrum.
Passed as part of <cite>kwargs</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>popt</strong><span class="classifier"><a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.MinimizerResult..">lmfit.MinimizerResult</a></span></dt><dd><p>The minimzer results from <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a> containing best-fit parameters
and fit details, e.g., exit status and reduced chi squared.
See documentation for <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a>.</p>
</dd>
<dt><strong>chi2</strong><span class="classifier">float</span></dt><dd><p>The chi squared value of the best-fit. Note that this value is <strong>not</strong>
the reduced chi squared. This value, and the number of degrees of freedom,
are available under the <cite>popt</cite> object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.fix_structure">
<span class="sig-name descname"><span class="pre">fix_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.fix_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.fix_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix the velocity structure, that is, the redshifts and the b-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ion</strong><span class="classifier">str   [default = None]</span></dt><dd><p>The ion for which the structure should be fixed.
If <cite>None</cite> is given, the structure is fixed for all ions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.free_structure">
<span class="sig-name descname"><span class="pre">free_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.free_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.free_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Free the velocity structure, that is, the redshifts and the b-parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ion</strong><span class="classifier">str   [default = None]</span></dt><dd><p>The ion for which the structure should be released.
If <cite>None</cite> is given, the structure is released for all ions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.get_lines_for_ion">
<span class="sig-name descname"><span class="pre">get_lines_for_ion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.get_lines_for_ion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.get_lines_for_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> objects
corresponding to the given <em>ion</em>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ion</strong><span class="classifier">str</span></dt><dd><p>The ion for the lines to get.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>lines_for_ion</strong><span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code>)</span></dt><dd><p>List of Lines defined for the given <em>ion</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.get_name">
<span class="sig-name descname"><span class="pre">get_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.get_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.get_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the DataSet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.get_resolution">
<span class="sig-name descname"><span class="pre">get_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.get_resolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.get_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the spectral resolution for the fitting <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code>
where the line with the given <cite>line_tag</cite> is defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>The line-tag for the line to look up: e.g., “FeII_2374”</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If <cite>True</cite>, print the returned spectral resolution to std out.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>resolutions</strong><span class="classifier">list of float</span></dt><dd><p>A list of the spectral resolution of the fitting regions
where the given line is defined.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.has_ion">
<span class="sig-name descname"><span class="pre">has_ion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.has_ion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.has_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the dataset has lines defined for the given ion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.has_line">
<span class="sig-name descname"><span class="pre">has_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.has_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.has_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the given line is defined.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.interactive_components">
<span class="sig-name descname"><span class="pre">interactive_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.interactive_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.interactive_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Define components interactively for a given ion. The components will be defined on the
basis of the given line for that ion. If the line is defined in several spectra
then the interactive window will show up for each.
Running the interactive mode more times for different transitions of the same ion
will append the components to the structure.
If no components should be added, then simply click <cite>enter</cite> to terminate the process
for the given transition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>Line tag for the line belonging to the ion for which components should be defined.</p>
</dd>
<dt><strong>velocity</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If a <cite>True</cite>, the region is displayed in velocity space
relative to the systemic redshift instead of in wavelength space.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This will launch an interactive plot showing the fitting region of the given line.
The user can then click on the positions of the components which. At the end, the
redshifts and estimated column densities are printed to terminal. The b-parameter
is assumed to be unresolved, i.e., taken from the resolution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.load_components_from_file">
<span class="sig-name descname"><span class="pre">load_components_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.load_components_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.load_components_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load best-fit parameters from an output file <cite>fname</cite>.
If <cite>fit_pars</cite> is True, then update the best_fit parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.mask_line">
<span class="sig-name descname"><span class="pre">mask_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.mask_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.mask_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Define exclusion masks for the fitting region of a given line.
Note that the masked regions are exclusion regions and will not be used for the fit.
If components have been defined, these will be shown as vertical lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>Line tag for the <code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> whose
<code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code> should be masked.</p>
</dd>
<dt><strong>reset</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>True</cite>, clear the mask before defining a new mask.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">array_like, shape (n)   [default = None]</span></dt><dd><p>If the mask is given, it must be a boolean array of the same length
as the region flux, err, and wl arrays.
Passing a mask this was supresses the interactive masking process.</p>
</dd>
<dt><strong>telluric</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>True</cite>, a telluric absorption template and sky emission template
is shown for reference.</p>
</dd>
<dt><strong>velocity</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If a <cite>True</cite>, the regions are displayed in velocity space
relative to the systemic redshift instead of in wavelength space
when masking and defining continuum normalization interactively.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.mask_range">
<span class="sig-name descname"><span class="pre">mask_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.mask_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.mask_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Define mask in a range from <cite>x1</cite> to <cite>x2</cite> in velocity space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.normalize_line">
<span class="sig-name descname"><span class="pre">normalize_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spline'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.normalize_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.normalize_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize or re-normalize a given line</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>Line tag of the line whose fitting region should be normalized.</p>
</dd>
<dt><strong>norm_method</strong><span class="classifier">str   [default = ‘spline’]</span></dt><dd><p>Normalization method used for the interactive continuum fit.
Should be on of: [“spline”, “linear”]</p>
</dd>
<dt><strong>velocity</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If a <cite>True</cite>, the regions are displayed in velocity space
relative to the systemic redshift instead of in wavelength space
when masking and defining continuum normalization interactively.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.plot_fit">
<span class="sig-name descname"><span class="pre">plot_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsample_profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_resid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_all_ions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hl_line_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.plot_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <em>all</em> the absorption lines and the best-fit profiles.
For details, see <a class="reference internal" href="#VoigtFit.output.plot_all_lines" title="VoigtFit.output.plot_all_lines"><code class="xref py py-func docutils literal notranslate"><span class="pre">VoigtFit.output.plot_all_lines()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.plot_line">
<span class="sig-name descname"><span class="pre">plot_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nolabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsample_profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_resid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_all_ions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'velocity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hl_line_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.plot_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.plot_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a single fitting <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code>
containing the line corresponding to the given <cite>line_tag</cite>.
For details, see <code class="xref py py-func docutils literal notranslate"><span class="pre">output.plot_single_line()</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.prepare_dataset">
<span class="sig-name descname"><span class="pre">prepare_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.prepare_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.prepare_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the data for fitting. This function sets up the parameter structure,
and handles the normalization and masking of fitting regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>norm</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>Opens an interactive window to let the user normalize each region
using the defined <code class="xref py py-attr docutils literal notranslate"><span class="pre">norm_method</span></code>.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>Opens an interactive window to let the user mask each fitting region.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If this is set, the code will print small info statements during the run.</p>
</dd>
<dt><strong>active_only</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If True, only define masks for active lines.</p>
</dd>
<dt><strong>force_clean</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If this is True, components for inactive elements will be removed.</p>
</dd>
<dt><strong>velocity</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If <cite>True</cite>, the regions are displayed in velocity space
relative to the systemic redshift instead of in wavelength space
when masking and defining continuum normalization interactively.</p>
</dd>
<dt><strong>check_lines</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>True</cite>, all available lines covered by the data will be checked.
The user will be propmted if lines are available for ions that have
already been defined.</p>
</dd>
<dt><strong>f_lower</strong><span class="classifier">float   [default = 0.]</span></dt><dd><p>Lower limit on oscillator strengths for transitions when verifying
all transitions for defined ions.</p>
</dd>
<dt><strong>f_upper</strong><span class="classifier">float   [default = 100.]</span></dt><dd><p>Upper limit on oscillator strengths for transitions when verifying
all transitions for defined ions.</p>
</dd>
<dt><strong>l_lower</strong><span class="classifier">float   [default = 0.]</span></dt><dd><p>Lower limit on rest-frame wavelength for transitions when verifying
all transitions for defined ions.</p>
</dd>
<dt><strong>l_upper</strong><span class="classifier">float   [default = 1.e4]</span></dt><dd><p>Upper limit on rest-frame wavelength for transitions when verifying
all transitions for defined ions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd><p>The function returns <cite>True</cite> when the dataset has passed all the steps.
If one step fails, the function returns <cite>False</cite>.
The <code class="xref py py-attr docutils literal notranslate"><span class="pre">ready2fit</span></code> attribute of the dataset is also
updated accordingly.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.print_cont_parameters">
<span class="sig-name descname"><span class="pre">print_cont_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.print_cont_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.print_cont_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Print Chebyshev coefficients for the continuum fit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.print_metallicity">
<span class="sig-name descname"><span class="pre">print_metallicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logNHI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.print_metallicity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.print_metallicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the total column densities for each element relative to
HI in Solar units.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systemic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.print_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the best fit parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>velocity</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>True</cite>, show the relative velocities of each component instead of redshifts.</p>
</dd>
<dt><strong>elements</strong><span class="classifier">list(str)   [default = ‘all’]</span></dt><dd><p>A list of elements for which to show parameters.</p>
</dd>
<dt><strong>systemic</strong><span class="classifier">float   [default = None]</span></dt><dd><p>The systemic redshift used as reference for the relative velocities.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.print_total">
<span class="sig-name descname"><span class="pre">print_total</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.print_total"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.print_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the total column densities of all components.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.remove_fine_lines">
<span class="sig-name descname"><span class="pre">remove_fine_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.remove_fine_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.remove_fine_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove lines associated to a given fine-structure complex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>The line tag of the ground state transition to remove.</p>
</dd>
<dt><strong>levels</strong><span class="classifier">str, list(str)   [default = None]</span></dt><dd><p>The levels of the fine-structure complexes to remove, with “a” referring
to the first excited level, “b” is the second, etc..
Several levels can be given at once as a list: [‘a’, ‘b’]
or as a concatenated string: ‘abc’.
By default, all levels are included.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.remove_line">
<span class="sig-name descname"><span class="pre">remove_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.remove_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.remove_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an absorption line from the DataSet. If this is the last line
in a fitting region the given region will be eliminated, and if this
is the last line of a given ion, then the components will be eliminated
for that ion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>Line tag of the transition that should be removed.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.remove_molecule">
<span class="sig-name descname"><span class="pre">remove_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.remove_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.remove_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all lines for the given band of the given molecule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.reset_all_regions">
<span class="sig-name descname"><span class="pre">reset_all_regions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">active_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.reset_all_regions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.reset_all_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the data in all <code class="xref py py-class docutils literal notranslate"><span class="pre">Regions</span></code>
defined in the DataSet to use the raw input data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.reset_components">
<span class="sig-name descname"><span class="pre">reset_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.reset_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.reset_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset component structure for a given ion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ion</strong><span class="classifier">str   [default = None]</span></dt><dd><p>The ion for which to reset the components: e.g., ‘FeII’, ‘HI’, ‘CIa’, etc.
If <cite>None</cite> is given, <em>all</em> components for <em>all</em> ions will be reset.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.reset_region">
<span class="sig-name descname"><span class="pre">reset_region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.reset_region"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.reset_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the data in a given <code class="xref py py-class docutils literal notranslate"><span class="pre">regions.Region</span></code> to use the raw input data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the DataSet to file using the HDF5 format.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.save_cont_parameters_to_file">
<span class="sig-name descname"><span class="pre">save_cont_parameters_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.save_cont_parameters_to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.save_cont_parameters_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the best-fit continuum parameters to ASCII table output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str   [default = None]</span></dt><dd><p>If <cite>None</cite>, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> attribute will be used.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.save_fit_regions">
<span class="sig-name descname"><span class="pre">save_fit_regions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.save_fit_regions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.save_fit_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the fitting regions to ASCII table output.
The format is as follows:
(wavelength , normalized flux , normalized error , best-fit profile , mask)</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>filename</strong><span class="classifier">str   [default = None]</span></dt><dd><p>Filename for the fitting regions.
If <cite>None</cite>, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> attribute will be used.</p>
</dd>
<dt><strong>individual</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>Save the fitting regions to individual files.
By default all regions are concatenated into one file.</p>
</dd>
<dt><strong>path</strong><span class="classifier">str   [default = ‘’]</span></dt><dd><p>Specify a path to prepend to the filename in order to save output to a given
directory or path. Can be given both as relative or absolute path.
If the path doesn’t end in <cite>/</cite> it will be appended automatically.
The final filename will be:</p>
<blockquote>
<div><p><cite>path/</cite> + <cite>filename</cite> [+ <cite>_regN</cite>] + <cite>.reg</cite></p>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.save_parameters">
<span class="sig-name descname"><span class="pre">save_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.save_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.save_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the best-fit parameters to ASCII table output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Filename for the fit parameter file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.set_name">
<span class="sig-name descname"><span class="pre">set_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.set_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.set_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of the DataSet. This parameter is used when saving the dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.set_resolution">
<span class="sig-name descname"><span class="pre">set_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.set_resolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.set_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the spectral resolution in km/s for the <code class="xref py py-class docutils literal notranslate"><span class="pre">Region</span></code>
containing the line with the given <cite>line_tag</cite>. If multiple spectra are fitted
simultaneously, this method will set the same resolution for <em>all</em> spectra.
If <cite>line_tag</cite> is not given, the resolution will be set for <em>all</em> regions,
including the raw data chunks defined in <code class="xref py py-attr docutils literal notranslate"><span class="pre">VoigtFit.DataSet.data</span></code>!</p>
<p>Note – If not all data chunks have the same resolution, this method
should be used with caution. It is advised to check the spectral resolution beforehand
and only update the appropriate regions using a for-loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.set_systemic_redshift">
<span class="sig-name descname"><span class="pre">set_systemic_redshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_sys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.set_systemic_redshift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.set_systemic_redshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the systemic redshift of the dataset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.show_components">
<span class="sig-name descname"><span class="pre">show_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.show_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.show_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the defined components for a given <cite>ion</cite>.
By default, all ions are shown.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.show_lines">
<span class="sig-name descname"><span class="pre">show_lines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.show_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.show_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Print all defined lines to terminal.
The output shows whether the line is active or not
and the number of components for the given ion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.sum_components">
<span class="sig-name descname"><span class="pre">sum_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.sum_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.sum_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the total column density for the given <cite>components</cite>
of the given <cite>ion</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ions</strong><span class="classifier">str or list(str)</span></dt><dd><p>List of ions or a single ion for which to calculate the total
column density.</p>
</dd>
<dt><strong>components</strong><span class="classifier">list(int)</span></dt><dd><p>List of integers corresponding to the indeces of the components
to sum over.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>total_logN</strong><span class="classifier">dict()</span></dt><dd><p>Dictionary containing the log of total column density for each ion.</p>
</dd>
<dt><strong>total_logN_err</strong><span class="classifier">dict()</span></dt><dd><p>Dictionary containing the error on the log of total column density
for each ion.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.dataset.DataSet.velocity_plot">
<span class="sig-name descname"><span class="pre">velocity_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/dataset.html#DataSet.velocity_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.dataset.DataSet.velocity_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a velocity plot, showing all the fitting regions defined, in order to compare
different lines and to identify blends and contamination.</p>
</dd></dl>

</dd></dl>

</section>
<section id="class-component">
<h2>class <strong>Component</strong><a class="headerlink" href="#class-component" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="components.Component">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">components.</span></span><span class="sig-name descname"><span class="pre">Component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#components.Component" title="Permalink to this definition">¶</a></dt>
<dd><p>Component object which contains the parameters for each velocity component
of an absorption profile: redshift, z; broadning parameter, b; and column density
in log(cm^-2).
Options can control whether the components parameters are variable during the fit
or whether they are tied to another parameter using the <cite>var_</cite> and <cite>tie_</cite> options.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong></dt><dd></dd>
<dt><strong>logN</strong></dt><dd></dd>
<dt><strong>tie_N</strong></dt><dd></dd>
<dt><strong>tie_b</strong></dt><dd></dd>
<dt><strong>tie_z</strong></dt><dd></dd>
<dt><strong>var_N</strong></dt><dd></dd>
<dt><strong>var_b</strong></dt><dd></dd>
<dt><strong>var_z</strong></dt><dd></dd>
<dt><strong>z</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#components.Component.get_option" title="components.Component.get_option"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_option</span></code></a>(key)</p></td>
<td><p>Return the <cite>value</cite> for the given option, key must be either <cite>tie_</cite> or <cite>var_</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#components.Component.get_pars" title="components.Component.get_pars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pars</span></code></a>()</p></td>
<td><p>Unpack the physical parameters [z, b, logN]</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#components.Component.set_option" title="components.Component.set_option"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_option</span></code></a>(key, value)</p></td>
<td><p>Set the <cite>value</cite> for a given option, must be either <cite>tie_</cite> or <cite>var_</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="components.Component.get_option">
<span class="sig-name descname"><span class="pre">get_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component.get_option"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#components.Component.get_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <cite>value</cite> for the given option, key must be either <cite>tie_</cite> or <cite>var_</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="components.Component.get_pars">
<span class="sig-name descname"><span class="pre">get_pars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component.get_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#components.Component.get_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack the physical parameters [z, b, logN]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="components.Component.set_option">
<span class="sig-name descname"><span class="pre">set_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component.set_option"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#components.Component.set_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <cite>value</cite> for a given option, must be either <cite>tie_</cite> or <cite>var_</cite>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="class-line">
<h2>class <strong>Line</strong><a class="headerlink" href="#class-line" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lines.Line">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lines.</span></span><span class="sig-name descname"><span class="pre">Line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lines.Line" title="Permalink to this definition">¶</a></dt>
<dd><p>Line object containing atomic data for the given transition.
Only the line_tag is passed, the rest of the information is
looked up in the atomic database.</p>
<p class="rubric">Attributes</p>
<dl class="simple">
<dt>tag<span class="classifier">str</span></dt><dd><p>The line tag for the line, e.g., ‘FeII_2374’</p>
</dd>
<dt>ion<span class="classifier">str</span></dt><dd><p>The ion for the line; The ion for ‘FeII_2374’ is ‘FeII’.</p>
</dd>
<dt>element<span class="classifier">str</span></dt><dd><p>Equal to <cite>ion</cite> for backwards compatibility.</p>
</dd>
<dt>l0<span class="classifier">float</span></dt><dd><p>Rest-frame resonant wavelength of the transition.
Unit: Angstrom.</p>
</dd>
<dt>f<span class="classifier">float</span></dt><dd><p>The oscillator strength for the transition.</p>
</dd>
<dt>gam<span class="classifier">float</span></dt><dd><p>The radiation damping constant or Einstein coefficient.</p>
</dd>
<dt>mass<span class="classifier">float</span></dt><dd><p>The atomic mass in atomic mass units.</p>
</dd>
<dt>active<span class="classifier">bool   [default = True]</span></dt><dd><p>The state of the line in the dataset. Only active lines will
be included in the fit.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lines.Line.get_properties" title="lines.Line.get_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_properties</span></code></a>()</p></td>
<td><p>Return the principal atomic constants for the transition: <em>l0</em>, <em>f</em>, and <em>gam</em>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lines.Line.set_active" title="lines.Line.set_active"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_active</span></code></a>()</p></td>
<td><p>Set the line active; include the line in the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lines.Line.set_inactive" title="lines.Line.set_inactive"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_inactive</span></code></a>()</p></td>
<td><p>Set the line inactive; exclude the line in the fit.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="lines.Line.get_properties">
<span class="sig-name descname"><span class="pre">get_properties</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line.get_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lines.Line.get_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the principal atomic constants for the transition: <em>l0</em>, <em>f</em>, and <em>gam</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lines.Line.set_active">
<span class="sig-name descname"><span class="pre">set_active</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line.set_active"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lines.Line.set_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the line active; include the line in the fit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lines.Line.set_inactive">
<span class="sig-name descname"><span class="pre">set_inactive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line.set_inactive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lines.Line.set_inactive" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the line inactive; exclude the line in the fit.</p>
</dd></dl>

</dd></dl>

</section>
<section id="class-region">
<h2>class <strong>Region</strong><a class="headerlink" href="#class-region" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="VoigtFit.regions.Region">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">VoigtFit.regions.</span></span><span class="sig-name descname"><span class="pre">Region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">velspan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region" title="Permalink to this definition">¶</a></dt>
<dd><p>A Region contains the fitting data, exclusion mask and line information.
The class is instantiated with the velocity span, <cite>velspan</cite>, and a spectral ID
pointing to the raw data chunk from <cite>DataSet.data</cite>,
and can include a <code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code> instance for the first line
belonging to the region.</p>
<p class="rubric">Attributes</p>
<dl>
<dt>velspan<span class="classifier">float</span></dt><dd><p>The velocity range to used for the fitting region.</p>
</dd>
<dt>lines<span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code>)</span></dt><dd><p>A list of Lines defined in the region.</p>
</dd>
<dt>label<span class="classifier">str</span></dt><dd><p>A LaTeX label describing the lines in the region for plotting purposes.</p>
</dd>
<dt>res<span class="classifier">float</span></dt><dd><p>Spectral resolution of the region in km/s.</p>
</dd>
<dt>wl<span class="classifier">array_like, shape (N)</span></dt><dd><p>Data array of wavelengths in Ångstrøm.</p>
</dd>
<dt>flux<span class="classifier">array_like, shape (N)</span></dt><dd><p>Data array of fluxes (normalized if <code class="xref py py-attr docutils literal notranslate"><span class="pre">normalized</span></code> is <cite>True</cite>).</p>
</dd>
<dt>err<span class="classifier">array_like, shape (N)</span></dt><dd><p>Array of uncertainties for each flux element.</p>
</dd>
<dt>normalized<span class="classifier">bool</span></dt><dd><p><cite>True</cite> if the data in the region are normlized.</p>
</dd>
<dt>mask<span class="classifier">array_like, shape (N)</span></dt><dd><p>Exclusion mask for the region:
0/<cite>False</cite> = pixel is <em>not</em> included in the fit.
1/<cite>True</cite> = pixel is included in the fit.</p>
</dd>
<dt>new_mask<span class="classifier">bool</span></dt><dd><p>Internal parameter for <code class="xref py py-meth docutils literal notranslate"><span class="pre">VoigtFit.DataSet.prepare_dataset()</span></code>.
If <cite>True</cite>, an interactive masking process will be initiated in the
preparation stage.</p>
</dd>
<dt>cont_err<span class="classifier">float</span></dt><dd><p>An estimate of the uncertainty in the continuum fit.</p>
</dd>
<dt>specID<span class="classifier">str</span></dt><dd><p>A spectral identifier to point back to the raw data chunk.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.add_data_to_region" title="VoigtFit.regions.Region.add_data_to_region"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data_to_region</span></code></a>(data_chunk, cutout)</p></td>
<td><p>Define the spectral data for the fitting region.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.add_line" title="VoigtFit.regions.Region.add_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_line</span></code></a>(line)</p></td>
<td><p>Add a new <code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code> to the fitting region.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.clear_mask" title="VoigtFit.regions.Region.clear_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_mask</span></code></a>()</p></td>
<td><p>Clear the already defined mask in the region.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.define_mask" title="VoigtFit.regions.Region.define_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">define_mask</span></code></a>([z, dataset, telluric, z_sys])</p></td>
<td><p>Use an interactive window to define the mask for the region.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.generate_label" title="VoigtFit.regions.Region.generate_label"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_label</span></code></a>([active_only, ignore_finelines])</p></td>
<td><p>Automatically generate a descriptive label for the region.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.get_velocity" title="VoigtFit.regions.Region.get_velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_velocity</span></code></a>(z_sys[, line])</p></td>
<td><p>Return the relative velocities of the region, with respect to systemtic redshift of the given <cite>line</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.has_active_lines" title="VoigtFit.regions.Region.has_active_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_active_lines</span></code></a>()</p></td>
<td><p>Return <cite>True</cite> is at least one line in the region is active.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.has_line" title="VoigtFit.regions.Region.has_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_line</span></code></a>(line_tag)</p></td>
<td><p>Return <cite>True</cite> if a line with the given <cite>line_tag</cite> is defined in the region.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.is_normalized" title="VoigtFit.regions.Region.is_normalized"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_normalized</span></code></a>()</p></td>
<td><p>Return <cite>True</cite> if the region data is normalized.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.normalize" title="VoigtFit.regions.Region.normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize</span></code></a>([plot, norm_method, z_sys])</p></td>
<td><p>Normalize the region if the data are not already normalized.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.remove_line" title="VoigtFit.regions.Region.remove_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_line</span></code></a>(line_tag)</p></td>
<td><p>Remove absorption line with the given <cite>line_tag</cite> from the region.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.set_label" title="VoigtFit.regions.Region.set_label"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_label</span></code></a>(text)</p></td>
<td><p>Set descriptive text label for the given region.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#VoigtFit.regions.Region.unpack" title="VoigtFit.regions.Region.unpack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unpack</span></code></a>()</p></td>
<td><p>Return the data of the region (wl, flux, error, mask)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 66%" />
<col style="width: 34%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>evaluate_region</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>set_mask</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.add_data_to_region">
<span class="sig-name descname"><span class="pre">add_data_to_region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_chunk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.add_data_to_region"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.add_data_to_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the spectral data for the fitting region.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_chunk</strong><span class="classifier">dict()</span></dt><dd><p>A <cite>data_chunk</cite> as defined in the data structure of <code class="xref py py-meth docutils literal notranslate"><span class="pre">DataSet.data</span></code>.</p>
</dd>
<dt><strong>cutout</strong><span class="classifier">bool array</span></dt><dd><p>A boolean array defining the subset of the <cite>data_chunk</cite> which makes up the fitting region.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.add_line">
<span class="sig-name descname"><span class="pre">add_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.add_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.add_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.Line</span></code> to the fitting region.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.clear_mask">
<span class="sig-name descname"><span class="pre">clear_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.clear_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.clear_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the already defined mask in the region.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.define_mask">
<span class="sig-name descname"><span class="pre">define_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_sys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.define_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.define_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Use an interactive window to define the mask for the region.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z</strong><span class="classifier">float   [default = None]</span></dt><dd><p>If a redshift is given, the lines in the region are shown as vertical lines
at the given redshift.</p>
</dd>
<dt><strong>dataset</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code>   [default = None]</span></dt><dd><p>A dataset with components defined for the lines in the region.
If a dataset is passed, the components of the lines in the region are shown.</p>
</dd>
<dt><strong>telluric</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>Show telluric absorption and sky emission line templates during the masking.</p>
</dd>
<dt><strong>z_sys</strong><span class="classifier">float   [default = None]</span></dt><dd><p>If a systemic redshift is given, the region is displayed in velocity space
relative to the given systemic redshift instead of in wavelength space.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.generate_label">
<span class="sig-name descname"><span class="pre">generate_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">active_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_finelines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.generate_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.generate_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically generate a descriptive label for the region.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.get_velocity">
<span class="sig-name descname"><span class="pre">get_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_sys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.get_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.get_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the relative velocities of the region,
with respect to systemtic redshift of the given <cite>line</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.has_active_lines">
<span class="sig-name descname"><span class="pre">has_active_lines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.has_active_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.has_active_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <cite>True</cite> is at least one line in the region is active.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.has_line">
<span class="sig-name descname"><span class="pre">has_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.has_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.has_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <cite>True</cite> if a line with the given <cite>line_tag</cite> is defined in the region.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.is_normalized">
<span class="sig-name descname"><span class="pre">is_normalized</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.is_normalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.is_normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <cite>True</cite> if the region data is normalized.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_sys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the region if the data are not already normalized.
Choose from two methods:</p>
<blockquote>
<div><dl class="simple">
<dt>1:  define left and right continuum regions</dt><dd><p>and fit a linear continuum.</p>
</dd>
<dt>2:  define the continuum as a range of points</dt><dd><p>and use spline interpolation to infer the
continuum.</p>
</dd>
</dl>
</div></blockquote>
<p>If <cite>z_sys</cite> is not <cite>None</cite>, show the region in velocity space using
instead of wavelength space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.remove_line">
<span class="sig-name descname"><span class="pre">remove_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.remove_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.remove_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove absorption line with the given <cite>line_tag</cite> from the region.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.set_label">
<span class="sig-name descname"><span class="pre">set_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.set_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.set_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Set descriptive text label for the given region.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="VoigtFit.regions.Region.unpack">
<span class="sig-name descname"><span class="pre">unpack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/regions.html#Region.unpack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.regions.Region.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the data of the region (wl, flux, error, mask)</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-0">
<span id="module-voigt"></span><h2>module <strong>voigt</strong><a class="headerlink" href="#module-0" title="Permalink to this headline">¶</a></h2>
<p>The module contains functions to evaluate the optical depth,
to convert this to observed transmission and to convolve the
observed spectrum with the instrumental profile.</p>
<dl class="py function">
<dt class="sig sig-object py" id="voigt.H">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#H"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.H" title="Permalink to this definition">¶</a></dt>
<dd><p>Voigt Profile Approximation from T. Tepper-Garcia (2006, 2007).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.Voigt">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">Voigt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#Voigt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.Voigt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the optical depth Voigt profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>wl</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Wavelength grid in Angstroms at which to evaluate the optical depth.</p>
</dd>
<dt><strong>l0</strong><span class="classifier">float</span></dt><dd><p>Rest frame transition wavelength in Angstroms.</p>
</dd>
<dt><strong>f</strong><span class="classifier">float</span></dt><dd><p>Oscillator strength.</p>
</dd>
<dt><strong>N</strong><span class="classifier">float</span></dt><dd><p>Column density in units of cm^-2.</p>
</dd>
<dt><strong>b</strong><span class="classifier">float</span></dt><dd><p>Velocity width of the Voigt profile in cm/s.</p>
</dd>
<dt><strong>gam</strong><span class="classifier">float</span></dt><dd><p>Radiation damping constant, or Einstein constant (A_ul)</p>
</dd>
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>The redshift of the observed wavelength grid <cite>l</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tau</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Optical depth array evaluated at the input grid wavelengths <cite>l</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.convolve_numba">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">convolve_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#convolve_numba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.convolve_numba" title="Permalink to this definition">¶</a></dt>
<dd><p>Define convolution function for a wavelength dependent kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>P</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Intrinsic line profile.</p>
</dd>
<dt><strong>kernel</strong><span class="classifier">np.array, shape (N, M)</span></dt><dd><p>Each row of the <cite>kernel</cite> corresponds to the wavelength dependent
line-spread function (LSF) evaluated at each pixel of the input
profile <cite>P</cite>. Each LSF must be normalized!</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>P_con</strong><span class="classifier">np.array, shape (N)</span></dt><dd><p>Resulting profile after performing convolution with <cite>kernel</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is decorated by the <cite>jit</cite> decorator from <a class="reference external" href="http://numba.pydata.org/">numba</a> in order
to speed up the calculation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.convolve_profile">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">convolve_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#convolve_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.convolve_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolve with Gaussian kernel using constant width in pixels!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>profile</strong><span class="classifier">array, shape (N)</span></dt><dd><p>Input profile to convolve with a Gaussian kernel.</p>
</dd>
<dt><strong>width</strong><span class="classifier">float</span></dt><dd><p>Kernel width (or sigma) of the Gaussian profile in <strong>units of pixels</strong>.
Note – this should <em>not</em> be the FWHM, as is usually used to denote
the resolution element: <cite>width</cite> = FWHM / 2.35482</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>profile_obs</strong><span class="classifier">array, shape(N)</span></dt><dd><p>The convolved version of <cite>profile</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.evaluate_continuum">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">evaluate_continuum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#evaluate_continuum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.evaluate_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the continuum model using Chebyshev polynomials.
All regions are fitted with the same order of polynomials.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Input wavelength grid in Ångstrøm.</p>
</dd>
<dt><strong>pars</strong><span class="classifier">dict(<a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a>)</span></dt><dd><p>An instance of <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a> containing the Chebyshev
coefficients for each region.</p>
</dd>
<dt><strong>reg_num</strong><span class="classifier">int</span></dt><dd><p>The region number, i.e., the index of the region in the list
<code class="xref py py-attr docutils literal notranslate"><span class="pre">VoigtFit.DataSet.regions</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>cont_model</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>The continuum Chebyshev polynomial evaluated at the input wavelengths <cite>x</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.evaluate_optical_depth">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">evaluate_optical_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profile_wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_sys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#evaluate_optical_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.evaluate_optical_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate optical depth based on the component parameters in <cite>pars</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>profile_wl</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Wavelength array in Ångstrøm on which to evaluate the profile.</p>
</dd>
<dt><strong>pars</strong><span class="classifier">dict(<a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a>)</span></dt><dd><p>An instance of <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a> containing the line parameters.</p>
</dd>
<dt><strong>lines</strong><span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code>)</span></dt><dd><p>List of lines to evaluate. Should be a list of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> objects.</p>
</dd>
<dt><strong>z_sys</strong><span class="classifier">float or None</span></dt><dd><p>The systemic redshift, used to determine an effective wavelength range
within which to evaluate the profile. This is handy when fitting very large
regions, such as HI and metal lines together.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tau</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>The resulting optical depth of all <cite>lines</cite> in the wavelength region.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.evaluate_profile">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">evaluate_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_sys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_nsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#evaluate_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.evaluate_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the observed Voigt profile. The calculated optical depth, <cite>tau</cite>,
is converted to observed transmission, <cite>f</cite>:</p>
<div class="math notranslate nohighlight">
\[f = e^{-\tau}\]</div>
<p>The observed transmission is subsequently convolved with the instrumental
broadening profile assumed to be Gaussian with a full-width at half maximum
of res. The resolving power is assumed to be constant in velocity space.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Wavelength array in Ångstrøm on which to evaluate the profile.</p>
</dd>
<dt><strong>pars</strong><span class="classifier">dict(<a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a>)</span></dt><dd><p>An instance of <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a> containing the line parameters.</p>
</dd>
<dt><strong>lines</strong><span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code>)</span></dt><dd><p>List of lines to evaluate. Should be a list of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> objects.</p>
</dd>
<dt><strong>kernel</strong><span class="classifier">np.array, shape (N, M)  or float</span></dt><dd><p>The convolution kernel for each wavelength pixel.
If an array is given, each row of the array must specify
the line-spread function (LSF) at the given wavelength pixel.
The LSF must be normalized!
If a float is given, the resolution FWHM is given in km/s (c/R).
In this case the spectral resolution is assumed
to be constant in velocity space.</p>
</dd>
<dt><strong>z_sys</strong><span class="classifier">float or None</span></dt><dd><p>The systemic redshift, used to determine an effective wavelength range
within which to evaluate the profile. This is handy when fitting very large
regions, such as HI and metal lines together.</p>
</dd>
<dt><strong>sampling</strong><span class="classifier">integer  [default = 3]</span></dt><dd><p>The subsampling factor used for defining the input logarithmically
space wavelength grid. The number of pixels in the evaluation will
be sampling * N, where N is the number of input pixels.
The final profile will be interpolated back onto the original
wavelength grid defined by <cite>x</cite>.</p>
</dd>
<dt><strong>kernel_nsub</strong><span class="classifier">integer</span></dt><dd><p>Kernel subsampling factor relative to the data.
This is only used if the resolution is given as a LSF file.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>profile_obs</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Observed line profile convolved with the instrument profile.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.fwhm_to_pixels">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">fwhm_to_pixels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_wl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#fwhm_to_pixels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.fwhm_to_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert spectral resolution in wavelength to pixels
R = lambda / dlambda, where dlambda is the FWHM</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>wl</strong><span class="classifier">array, shape (N)</span></dt><dd><p>Input array of wavelength to evaluate</p>
</dd>
<dt><strong>res_wl</strong><span class="classifier">float</span></dt><dd><p>The input spectral resolution element (FWHM) in Ångström.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>w</strong><span class="classifier">float</span></dt><dd><p>Kernel width converted to pixels (to be used with <a class="reference internal" href="#voigt.convolve_profile" title="voigt.convolve_profile"><code class="xref py py-func docutils literal notranslate"><span class="pre">convolve_profile</span></code></a>).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.resvel_to_pixels">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">resvel_to_pixels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#resvel_to_pixels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.resvel_to_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert spectral resolution in km/s to pixels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>wl</strong><span class="classifier">array, shape (N)</span></dt><dd><p>Input array of wavelength to evaluate</p>
</dd>
<dt><strong>res</strong><span class="classifier">float</span></dt><dd><p>The input spectral velocity resolution in <strong>km/s</strong>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>w</strong><span class="classifier">float</span></dt><dd><p>Kernel width converted to velocity pixels (km/s).
(to be used with convolution of logarithmically-spaced data/models).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-VoigtFit.output">
<span id="module-output"></span><h2>module <strong>output</strong><a class="headerlink" href="#module-VoigtFit.output" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.chunks">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">chunks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#chunks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield successive <cite>n</cite>-sized chunks from <cite>l</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.create_blank_input">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">create_blank_input</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#create_blank_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.create_blank_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a blank template input parameter file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.load_lsf">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">load_lsf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lsf_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#load_lsf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.load_lsf" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a Line-Spread Function table following format from HST:
First line gives wavelength in Angstrom and the column below
each given wavelength defines the kernel in pixel space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wl1</span>    <span class="n">wl2</span>    <span class="n">wl3</span>   <span class="o">...</span>  <span class="n">wlN</span>
<span class="n">lsf11</span>  <span class="n">lsf21</span>  <span class="n">lsf31</span> <span class="o">...</span>  <span class="n">lsfN1</span>
<span class="n">lsf12</span>  <span class="n">lsf22</span>  <span class="n">lsf32</span> <span class="o">...</span>  <span class="n">lsfN2</span>
<span class="p">:</span>
<span class="p">:</span>
<span class="n">lsf1M</span>  <span class="n">lsf2M</span>  <span class="n">lsf3M</span> <span class="o">...</span>  <span class="n">lsfNM</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lsf_fname</strong><span class="classifier">string</span></dt><dd><p>The filename containing the LSF data.</p>
</dd>
<dt><strong>wl</strong><span class="classifier">array like, shape (N)</span></dt><dd><p>The wavelength grid onto which the LSF will be evaluated</p>
</dd>
<dt><strong>nsub</strong><span class="classifier">int  [default = 1]</span></dt><dd><p>Kernel subsampling factor relative to the data.
This is only used if the resolution is given as a LSF file.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>kernel</strong><span class="classifier">np.array, shape(N, M)</span></dt><dd><p>A grid of interpolated LSF evaluated at each given input wavelength
of the array <cite>wl</cite> of shape N, where M is the number of pixels in the LSF.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The output kernel is transposed with respect to the input format
for ease of computation in the convolution since indexing is faster
along rows than columns.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.mad">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">mad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#mad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.mad" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Median Absolute Deviation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.merge_two_dicts">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">merge_two_dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#merge_two_dicts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.merge_two_dicts" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge the keys of dictionary <cite>x</cite> into dictionary <cite>default</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.plot_H2">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">plot_H2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">short_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#plot_H2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.plot_H2" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate plot for H2 absorption lines.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>dataset</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code></span></dt><dd><p>An instance of the class <code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code> containing
the H2 lines to plot.</p>
</dd>
<dt><strong>n_rows</strong><span class="classifier">int   [default = None]</span></dt><dd><p>Number of rows to show in figure.
If None, the number will be determined automatically.</p>
</dd>
<dt><strong>xmin</strong><span class="classifier">float</span></dt><dd><p>The lower x-limit in Å.
If nothing is given, the extent of the fit region is used.</p>
</dd>
<dt><strong>xmax</strong><span class="classifier">float</span></dt><dd><p>The upper x-limit in Å.
If nothing is given, the extent of the fit region is used.</p>
</dd>
<dt><strong>ymin</strong><span class="classifier">float   [default = -0.1]</span></dt><dd><p>The lower y-limit in normalized flux units.</p>
</dd>
<dt><strong>ymax</strong><span class="classifier">float   [default = 2.5]</span></dt><dd><p>The upper y-limit in normalized flux units.</p>
</dd>
<dt><strong>rebin</strong><span class="classifier">int   [defualt = 1]</span></dt><dd><p>Rebinning factor for the spectrum, default is no binning.</p>
</dd>
<dt><strong>smooth</strong><span class="classifier">float   [default = 0]</span></dt><dd><p>Width of Gaussian kernel for smoothing.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.plot_all_lines">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">plot_all_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsample_profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_resid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_all_ions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hl_line_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#plot_all_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.plot_all_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all active absorption lines. This function is a wrapper of
<a class="reference internal" href="#VoigtFit.output.plot_single_line" title="VoigtFit.output.plot_single_line"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_single_line()</span></code></a>. For a complete description of input parameters,
see the documentation for <a class="reference internal" href="#VoigtFit.output.plot_single_line" title="VoigtFit.output.plot_single_line"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_single_line()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>dataset</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code></span></dt><dd><p>Instance of the <code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code> class containing the line
regions to plot.</p>
</dd>
<dt><strong>max_rows</strong><span class="classifier">int   [default = 4]</span></dt><dd><p>The maximum number of rows of figures.
Each row consists of two figure panels.</p>
</dd>
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>If a filename is given, the figures are saved to a pdf file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.plot_excitation">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">plot_excitation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#plot_excitation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.plot_excitation" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the excitation diagram for a given <cite>molecule</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.plot_residual">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">plot_residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#plot_residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.plot_residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot residuals for the best-fit to a given absorption line.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>dataset</strong><span class="classifier">class DataSet</span></dt><dd><p>An instance of DataSet class containing the line region to plot.</p>
</dd>
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>The line tag of the line to show, e.g., ‘FeII_2374’</p>
</dd>
<dt><strong>index</strong><span class="classifier">int   [default = 0]</span></dt><dd><p>The line index. When fitting the same line in multiple
spectra this indexed points to the index of the given region
to be plotted.</p>
</dd>
<dt><strong>rebin: int</strong></dt><dd><p>Integer factor for rebinning the spectral data.</p>
</dd>
<dt><strong>xmin</strong><span class="classifier">float</span></dt><dd><p>The lower x-limit in relative velocity (km/s).
If nothing is given, the extent of the region is used.</p>
</dd>
<dt><strong>xmax</strong><span class="classifier">float</span></dt><dd><p>The upper x-limit in relative velocity (km/s).
If nothing is given, the extent of the region is used.</p>
</dd>
<dt><strong>axis</strong><span class="classifier"><a class="reference external" href="https://matplotlib.org/api/axes_api.html">matplotlib.axes.Axes</a></span></dt><dd><p>The plotting axis of matplotlib.
If <cite>None</cite> is given, a new figure and axis will be created.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.plot_single_line">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">plot_single_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nolabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsample_profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_resid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_all_ions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'velocity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hl_line_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#plot_single_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.plot_single_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a single absorption line.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>dataset</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code></span></dt><dd><p>Instance of the <code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code> class containing the lines</p>
</dd>
<dt><strong>line_tag</strong><span class="classifier">str</span></dt><dd><p>The line tag of the line to show, e.g., ‘FeII_2374’</p>
</dd>
<dt><strong>index</strong><span class="classifier">int   [default = 0]</span></dt><dd><p>The line index. When fitting the same line in multiple
spectra this indexed points to the index of the given
region to be plotted.</p>
</dd>
<dt><strong>plot_fit</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If <cite>True</cite>, the best-fit profile will be shown</p>
</dd>
<dt><strong>loc</strong><span class="classifier">str   [default = ‘left’]</span></dt><dd><p>Places the line tag (right or left).</p>
</dd>
<dt><strong>rebin</strong><span class="classifier">int   [default = 1]</span></dt><dd><p>Rebinning factor for the spectrum</p>
</dd>
<dt><strong>nolabels</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If <cite>True</cite>, show the axis x- and y-labels.</p>
</dd>
<dt><strong>axis</strong><span class="classifier"><a class="reference external" href="https://matplotlib.org/api/axes_api.html">matplotlib.axes.Axes</a></span></dt><dd><p>The plotting axis of matplotlib.
If <cite>None</cite> is given, a new figure and axis will be created.</p>
</dd>
<dt><strong>fontsize</strong><span class="classifier">int   [default = 12]</span></dt><dd><p>The fontsize of text labels.</p>
</dd>
<dt><strong>xmin</strong><span class="classifier">float</span></dt><dd><p>The lower x-limit in relative velocity (km/s).
If nothing is given, the extent of the region is used.</p>
</dd>
<dt><strong>xmax</strong><span class="classifier">float</span></dt><dd><p>The upper x-limit in relative velocity (km/s).
If nothing is given, the extent of the region is used.</p>
</dd>
<dt><strong>ymin</strong><span class="classifier">float   [default = None]</span></dt><dd><p>The lower y-limit in normalized flux units.
Default is determined from the data.</p>
</dd>
<dt><strong>ymax</strong><span class="classifier">float   [default = None]</span></dt><dd><p>The upper y-limit in normalized flux units.
Default is determined from the data.</p>
</dd>
<dt><strong>show</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>Show the figure.</p>
</dd>
<dt><strong>subsample_profile</strong><span class="classifier">int   [default = 1]</span></dt><dd><p>Subsampling factor to calculate the profile on a finer grid than
the data sampling.
By default the profile is evaluated on the same grid as the data.</p>
</dd>
<dt><strong>npad</strong><span class="classifier">int   [default = 50]</span></dt><dd><p>Padding added to the synthetic profile before convolution.
This removes end artefacts from the <cite>FFT</cite> routine.</p>
</dd>
<dt><strong>residuals</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>Add a panel above the absorption line to show the residuals of the fit.</p>
</dd>
<dt><strong>norm_resid</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>Show normalized residuals.</p>
</dd>
<dt><strong>legend</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>Show line labels as axis legend.</p>
</dd>
<dt><strong>default_props</strong><span class="classifier">dict</span></dt><dd><p>Dictionary of transition tick marker properties. The dictionary is
passed to matplotlib.axes.Axes.axvline to control color, linewidth,
linestyle, etc.. Two additional keywords can be defined:
The keyword <cite>text</cite> is a string that will be printed above or below
each tick mark for each element.
The keyword <cite>loc</cite> controls the placement of the tick mark text
for the transistions, and must be one either ‘above’ or ‘below’.</p>
</dd>
<dt><strong>element_props</strong><span class="classifier">dict</span></dt><dd><p>Dictionary of properties for individual elements.
Each element defines a dictionary with individual properties following
the format for <cite>default_props</cite>.</p>
<blockquote>
<div><dl class="simple">
<dt>Ex: <code class="docutils literal notranslate"><span class="pre">element_props={'SiII':</span> <span class="pre">{'color':</span> <span class="pre">'red',</span> <span class="pre">'lw':</span> <span class="pre">1.5},</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">'FeII':</span> <span class="pre">{'ls':</span> <span class="pre">'--',</span> <span class="pre">'alpha':</span> <span class="pre">0.2}}</span></code></p>
</dd>
</dl>
</div></blockquote>
<p>This will set the color and linewidth of the tick marks
of SiII transitions and the linestyle and alpha-parameter
of FeII transitions.</p>
</dd>
<dt><strong>highlight_props</strong><span class="classifier">dict/list   [default = None]</span></dt><dd><p>A dictionary of <cite>ions</cite> (e.g., “FeII”, “CIa”, etc.) used to calculate
a separate profile for this subset of ions. Each <cite>ion</cite> as a keyword
must specify a dictionary which can change individual properties for
the given <cite>ion</cite>. Similar to <cite>element_props</cite>.
If an empty dictionary is given, the default parameters will be used.
Alternatively, a list of <cite>ions</cite> can be given to use default properties
for all <cite>ions</cite>.</p>
<blockquote>
<div><p>Ex: <code class="docutils literal notranslate"><span class="pre">highlight_props={'SiII':{},</span> <span class="pre">'FeII':{'color':</span> <span class="pre">'blue'}}</span></code></p>
</div></blockquote>
<p>This will highlight SiII transitions with default highlight
properties, and FeII transistions with a user specified color.</p>
<blockquote>
<div><p>Ex: <code class="docutils literal notranslate"><span class="pre">highlight_props=['SiII',</span> <span class="pre">'FeII']</span></code></p>
</div></blockquote>
<p>This will highlight SiII and FeII transitions using default
highlight properties.</p>
</dd>
<dt><strong>label_all_ions</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>Show labels for all <cite>ions</cite> defined.
The labels will appear above the component tick marks.</p>
</dd>
<dt><strong>xunit</strong><span class="classifier">string   [default = ‘velocity’]</span></dt><dd><p>The unit of the x-axis, must be either ‘velocity’ or ‘wavelength’.
Shortenings are acceptable too, e.g., ‘vel’/’v’ or ‘wave’/’wl’.</p>
</dd>
<dt><strong>line_props</strong><span class="classifier">dict   [default = None]</span></dt><dd><p>A dictionary of keywords to change the default line properties
of the best-fit profile; e.g., ‘color’, ‘lw’, ‘linestyle’.
All keywords will be passed to the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html">plot</a> function of matplotlib.</p>
</dd>
<dt><strong>hl_line_props</strong><span class="classifier">dict   [default = None]</span></dt><dd><p>A dictionary of keywords to change the default line properties
of the best-fit profile for highlighted ions.
All keywords will be passed to the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html">plot</a> function of matplotlib.</p>
</dd>
<dt><strong>sort_f</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>If <cite>True</cite>, calculate velocities with respect to the line with the
largest oscillator strength. Otherwise, use the given <cite>line_tag</cite>
as reference.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.print_T_model_pars">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">print_T_model_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermal_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#print_T_model_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.print_T_model_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the turbulence and temperature parameters for physical model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.print_cont_parameters">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">print_cont_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#print_cont_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.print_cont_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the Chebyshev coefficients of the continuum normalization.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.print_metallicity">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">print_metallicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logNHI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#print_metallicity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.print_metallicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the metallicity derived from different species.
This will add the column densities for all components of a given ion.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>dataset</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code></span></dt><dd><p>An instance of the <code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code> class containing
the definition of data and absorption lines.</p>
</dd>
<dt><strong>params</strong><span class="classifier"><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a></span></dt><dd><p>Output parameter dictionary, e.g., <code class="xref py py-attr docutils literal notranslate"><span class="pre">VoigtFit.DataSet.best_fit</span></code>.
See <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a> for details.</p>
</dd>
<dt><strong>logNHI</strong><span class="classifier">float</span></dt><dd><p>Column density of neutral hydrogen.</p>
</dd>
<dt><strong>err</strong><span class="classifier">float   [default = 0.1]</span></dt><dd><p>Uncertainty (1-sigma) on <cite>logNHI</cite>.</p>
</dd>
<dt><strong>.. _lmfit: https://lmfit.github.io/lmfit-py/index.html</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.print_results">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systemic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#print_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the parameters of the best-fit.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>dataset</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code></span></dt><dd><p>An instance of the <code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code> class containing
the line region to plot.</p>
</dd>
<dt><strong>params</strong><span class="classifier"><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">lmfit.Parameters</a></span></dt><dd><p>Output parameter dictionary, e.g., <code class="xref py py-attr docutils literal notranslate"><span class="pre">dataset.Dataset.best_fit</span></code>.
See <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a> for details.</p>
</dd>
<dt><strong>elements</strong><span class="classifier">list(str)   [default = ‘all’]</span></dt><dd><p>A list of ions for which to print the best-fit parameters.
By default all ions are shown.</p>
</dd>
<dt><strong>velocity</strong><span class="classifier">bool   [default = True]</span></dt><dd><p>Show the components in relative velocity or redshift.</p>
</dd>
<dt><strong>systemic</strong><span class="classifier">float   [default = 0]</span></dt><dd><p>Systemic redshift used to calculate the relative velocities.
By default the systemic redshift defined in the dataset is used.</p>
</dd>
<dt><strong>.. _lmfit: https://lmfit.github.io/lmfit-py/index.html</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.print_total">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">print_total</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#print_total"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.print_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the total column densities of all species. This will sum <em>all</em>
the components of each ion. The uncertainty on the total column density
is calculated using random resampling within the errors of each component.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.rebin_bool_array">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">rebin_bool_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#rebin_bool_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.rebin_bool_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin input boolean array <cite>x</cite> by an integer factor of <cite>n</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.rebin_spectrum">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">rebin_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#rebin_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.rebin_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin input spectrum by a factor of <cite>n</cite>.
Method is either <em>mean</em> or <em>median</em>, default is mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>wl</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Input wavelength array.</p>
</dd>
<dt><strong>spec</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Input flux array.</p>
</dd>
<dt><strong>err</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Input error array.</p>
</dd>
<dt><strong>n</strong><span class="classifier">int</span></dt><dd><p>Integer rebinning factor.</p>
</dd>
<dt><strong>method</strong><span class="classifier">str   [default = ‘mean’]</span></dt><dd><p>Rebin method, either ‘mean’ or ‘median’.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>wl_r</strong><span class="classifier">array_like, shape (M)</span></dt><dd><p>Rebinned wavelength array, the new shape will be N/n.</p>
</dd>
<dt><strong>spec_r</strong><span class="classifier">array_like, shape (M)</span></dt><dd><p>Rebinned flux array, the new shape will be N/n.</p>
</dd>
<dt><strong>err_r</strong><span class="classifier">array_like, shape (M)</span></dt><dd><p>Rebinned error array, the new shape will be N/n.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.save_EW">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">save_EW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">EW_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#save_EW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.save_EW" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the equivalent width data for each line in the input list.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>EW_list</strong><span class="classifier">list[<cite>namedtuple</cite> (EquivalentWidth)]</span></dt><dd><p>A list of <cite>namedtuple</cite> (EquivalentWidth), see implementation in <cite>VoigtFit.dataset.py</cite></p>
</dd>
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Filename to be used. If the filename already exists, it will be overwritten.</p>
</dd>
<dt><strong>path</strong><span class="classifier">str   [default = ‘’]</span></dt><dd><p>Specify a path to prepend to the filename in order to save output to a given
directory or path. Can be given both as relative or absolute path.
If the directory does not exist, it will be created.
The final filename will be:</p>
<blockquote>
<div><p><cite>path/</cite> + <cite>filename</cite></p>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.save_cont_parameters_to_file">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">save_cont_parameters_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#save_cont_parameters_to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.save_cont_parameters_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Save Chebyshev coefficients to file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.save_fit_regions">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">save_fit_regions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#save_fit_regions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.save_fit_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Save fit regions to ASCII file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Filename to be used. If the filename already exists, it will be overwritten.
A <cite>.reg</cite> file extension will automatically be append if not present already.</p>
</dd>
<dt><strong>individual</strong><span class="classifier">bool   [default = False]</span></dt><dd><p>If <cite>True</cite>, save each fitting region to a separate file.
The individual filenames will be the basename given as <cite>filename</cite>
with <cite>_regN</cite> appended, where <cite>N</cite> is an integer referring to the region number.</p>
</dd>
<dt><strong>path</strong><span class="classifier">str   [default = ‘’]</span></dt><dd><p>Specify a path to prepend to the filename in order to save output to a given
directory or path. Can be given both as relative or absolute path.
If the directory does not exist, it will be created.
The final filename will be:</p>
<blockquote>
<div><p><cite>path/</cite> + <cite>filename</cite> [+ <cite>_regN</cite>] + <cite>.reg</cite></p>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.save_individual_components">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">save_individual_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#save_individual_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.save_individual_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Save best-fit profile to ASCII file for each individual component of each ion.
By default the profiles are calcuated on a logarithmically binned wavelength
array over the entire range of the input data. If a sampling factor other than
one is given, the wavelength grid is subsampled by this factor.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>dataset</strong><span class="classifier">dataset.DataSet</span></dt><dd><p>Dataset with the fitted data and parameters</p>
</dd>
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Filename to be used. If the filename already exists, it will be overwritten.</p>
</dd>
<dt><strong>path</strong><span class="classifier">str   [default = ‘’]</span></dt><dd><p>Specify a path to prepend to the filename in order to save output to a given
directory or path. Can be given both as relative or absolute path.
If the directory does not exist, it will be created.
The final filename will be:</p>
<blockquote>
<div><p><cite>path/</cite> + <cite>filename</cite></p>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.save_parameters_to_file">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">save_parameters_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#save_parameters_to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.save_parameters_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Save best-fit parameters to file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.show_H2_bands">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">show_H2_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Jmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">short_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#show_H2_bands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.show_H2_bands" title="Permalink to this definition">¶</a></dt>
<dd><p>Add molecular H2 band identifications to a given matplotlib axis.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ax</strong><span class="classifier"><a class="reference external" href="https://matplotlib.org/api/axes_api.html">matplotlib.axes.Axes</a></span></dt><dd><p>The axis instance to decorate with H2 line identifications.</p>
</dd>
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>The redshift of the H2 system.</p>
</dd>
<dt><strong>bands</strong><span class="classifier">list(str)</span></dt><dd><p>A list of molecular bands of H2.
Ex: [‘BX(0-0)’, ‘BX(1-0)’]</p>
</dd>
<dt><strong>Jmax</strong><span class="classifier">int or list(int)</span></dt><dd><p>The highest rotational J-level to include in the identification.
A list of Jmax for each band can be passed as well.
Lines are currently only defined up to J=7.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.show_components">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">show_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#show_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.show_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the defined components for a given <cite>ion</cite>.
By default, all ions are shown.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="VoigtFit.output.sum_components">
<span class="sig-prename descclassname"><span class="pre">VoigtFit.output.</span></span><span class="sig-name descname"><span class="pre">sum_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/VoigtFit/output.html#sum_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VoigtFit.output.sum_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the total abundance for given <cite>components</cite> of the given <cite>ion</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>dataset</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code></span></dt><dd><p>An instance of the <code class="xref py py-class docutils literal notranslate"><span class="pre">VoigtFit.DataSet</span></code> class containing
the definition of data and absorption lines.</p>
</dd>
<dt><strong>ion</strong><span class="classifier">str</span></dt><dd><p>Ion for which to calculate the summed abundance.</p>
</dd>
<dt><strong>components</strong><span class="classifier">list(int)</span></dt><dd><p>List of indeces of the components to sum over.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>total_logN</strong><span class="classifier">float</span></dt><dd><p>The 10-base log of total column density.</p>
</dd>
<dt><strong>total_logN_err</strong><span class="classifier">float</span></dt><dd><p>The error on the 10-base log of total column density.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">VoigtFit Parameter Language</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">VoigtFit Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#class-dataset">class <strong>DataSet</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-component">class <strong>Component</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-line">class <strong>Line</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-region">class <strong>Region</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-0">module <strong>voigt</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-VoigtFit.output">module <strong>output</strong></a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="physical_model_results.html">Results of Physical Model</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Jens-Kristian Krogager.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>