
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>VoigtFit Interface &#8212; VoigtFit 0.13.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Results of Physical Model" href="physical_model_results.html" />
    <link rel="prev" title="VoigtFit Parameter Language" href="documentation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <pre class="logo literal-block">____  _           _________________________________________
    \/ \  _/\    /
        \/   \  / oigtFit
              \/</pre>
<section id="voigtfit-interface">
<h1>VoigtFit Interface<a class="headerlink" href="#voigtfit-interface" title="Permalink to this headline">¶</a></h1>
<section id="class-dataset">
<h2>class <strong>DataSet</strong><a class="headerlink" href="#class-dataset" title="Permalink to this headline">¶</a></h2>
</section>
<section id="class-component">
<h2>class <strong>Component</strong><a class="headerlink" href="#class-component" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="components.Component">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">components.</span></span><span class="sig-name descname"><span class="pre">Component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#components.Component" title="Permalink to this definition">¶</a></dt>
<dd><p>Component object which contains the parameters for each velocity component
of an absorption profile: redshift, z; broadning parameter, b; and column density
in log(cm^-2).
Options can control whether the components parameters are variable during the fit
or whether they are tied to another parameter using the <cite>var_</cite> and <cite>tie_</cite> options.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong></dt><dd></dd>
<dt><strong>logN</strong></dt><dd></dd>
<dt><strong>tie_N</strong></dt><dd></dd>
<dt><strong>tie_b</strong></dt><dd></dd>
<dt><strong>tie_z</strong></dt><dd></dd>
<dt><strong>var_N</strong></dt><dd></dd>
<dt><strong>var_b</strong></dt><dd></dd>
<dt><strong>var_z</strong></dt><dd></dd>
<dt><strong>z</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#components.Component.get_option" title="components.Component.get_option"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_option</span></code></a>(key)</p></td>
<td><p>Return the <cite>value</cite> for the given option, key must be either <cite>tie_</cite> or <cite>var_</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#components.Component.get_pars" title="components.Component.get_pars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pars</span></code></a>()</p></td>
<td><p>Unpack the physical parameters [z, b, logN]</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#components.Component.set_option" title="components.Component.set_option"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_option</span></code></a>(key, value)</p></td>
<td><p>Set the <cite>value</cite> for a given option, must be either <cite>tie_</cite> or <cite>var_</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="components.Component.get_option">
<span class="sig-name descname"><span class="pre">get_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component.get_option"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#components.Component.get_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <cite>value</cite> for the given option, key must be either <cite>tie_</cite> or <cite>var_</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="components.Component.get_pars">
<span class="sig-name descname"><span class="pre">get_pars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component.get_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#components.Component.get_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack the physical parameters [z, b, logN]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="components.Component.set_option">
<span class="sig-name descname"><span class="pre">set_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/components.html#Component.set_option"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#components.Component.set_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <cite>value</cite> for a given option, must be either <cite>tie_</cite> or <cite>var_</cite>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="class-line">
<h2>class <strong>Line</strong><a class="headerlink" href="#class-line" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lines.Line">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lines.</span></span><span class="sig-name descname"><span class="pre">Line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lines.Line" title="Permalink to this definition">¶</a></dt>
<dd><p>Line object containing atomic data for the given transition.
Only the line_tag is passed, the rest of the information is
looked up in the atomic database.</p>
<p class="rubric">Attributes</p>
<dl class="simple">
<dt>tag<span class="classifier">str</span></dt><dd><p>The line tag for the line, e.g., ‘FeII_2374’</p>
</dd>
<dt>ion<span class="classifier">str</span></dt><dd><p>The ion for the line; The ion for ‘FeII_2374’ is ‘FeII’.</p>
</dd>
<dt>element<span class="classifier">str</span></dt><dd><p>Equal to <cite>ion</cite> for backwards compatibility.</p>
</dd>
<dt>l0<span class="classifier">float</span></dt><dd><p>Rest-frame resonant wavelength of the transition.
Unit: Angstrom.</p>
</dd>
<dt>f<span class="classifier">float</span></dt><dd><p>The oscillator strength for the transition.</p>
</dd>
<dt>gam<span class="classifier">float</span></dt><dd><p>The radiation damping constant or Einstein coefficient.</p>
</dd>
<dt>mass<span class="classifier">float</span></dt><dd><p>The atomic mass in atomic mass units.</p>
</dd>
<dt>active<span class="classifier">bool   [default = True]</span></dt><dd><p>The state of the line in the dataset. Only active lines will
be included in the fit.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lines.Line.get_properties" title="lines.Line.get_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_properties</span></code></a>()</p></td>
<td><p>Return the principal atomic constants for the transition: <em>l0</em>, <em>f</em>, and <em>gam</em>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lines.Line.set_active" title="lines.Line.set_active"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_active</span></code></a>()</p></td>
<td><p>Set the line active; include the line in the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lines.Line.set_inactive" title="lines.Line.set_inactive"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_inactive</span></code></a>()</p></td>
<td><p>Set the line inactive; exclude the line in the fit.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="lines.Line.get_properties">
<span class="sig-name descname"><span class="pre">get_properties</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line.get_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lines.Line.get_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the principal atomic constants for the transition: <em>l0</em>, <em>f</em>, and <em>gam</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lines.Line.set_active">
<span class="sig-name descname"><span class="pre">set_active</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line.set_active"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lines.Line.set_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the line active; include the line in the fit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lines.Line.set_inactive">
<span class="sig-name descname"><span class="pre">set_inactive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lines.html#Line.set_inactive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lines.Line.set_inactive" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the line inactive; exclude the line in the fit.</p>
</dd></dl>

</dd></dl>

</section>
<section id="class-region">
<h2>class <strong>Region</strong><a class="headerlink" href="#class-region" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-0">
<span id="module-voigt"></span><h2>module <strong>voigt</strong><a class="headerlink" href="#module-0" title="Permalink to this headline">¶</a></h2>
<p>The module contains functions to evaluate the optical depth,
to convert this to observed transmission and to convolve the
observed spectrum with the instrumental profile.</p>
<dl class="py function">
<dt class="sig sig-object py" id="voigt.H">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#H"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.H" title="Permalink to this definition">¶</a></dt>
<dd><p>Voigt Profile Approximation from T. Tepper-Garcia (2006, 2007).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.Voigt">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">Voigt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#Voigt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.Voigt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the optical depth Voigt profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>wl</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Wavelength grid in Angstroms at which to evaluate the optical depth.</p>
</dd>
<dt><strong>l0</strong><span class="classifier">float</span></dt><dd><p>Rest frame transition wavelength in Angstroms.</p>
</dd>
<dt><strong>f</strong><span class="classifier">float</span></dt><dd><p>Oscillator strength.</p>
</dd>
<dt><strong>N</strong><span class="classifier">float</span></dt><dd><p>Column density in units of cm^-2.</p>
</dd>
<dt><strong>b</strong><span class="classifier">float</span></dt><dd><p>Velocity width of the Voigt profile in cm/s.</p>
</dd>
<dt><strong>gam</strong><span class="classifier">float</span></dt><dd><p>Radiation damping constant, or Einstein constant (A_ul)</p>
</dd>
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>The redshift of the observed wavelength grid <cite>l</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tau</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Optical depth array evaluated at the input grid wavelengths <cite>l</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.convolve_numba">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">convolve_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#convolve_numba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.convolve_numba" title="Permalink to this definition">¶</a></dt>
<dd><p>Define convolution function for a wavelength dependent kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>P</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Intrinsic line profile.</p>
</dd>
<dt><strong>kernel</strong><span class="classifier">np.array, shape (N, M)</span></dt><dd><p>Each row of the <cite>kernel</cite> corresponds to the wavelength dependent
line-spread function (LSF) evaluated at each pixel of the input
profile <cite>P</cite>. Each LSF must be normalized!</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>P_con</strong><span class="classifier">np.array, shape (N)</span></dt><dd><p>Resulting profile after performing convolution with <cite>kernel</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is decorated by the <cite>jit</cite> decorator from <a class="reference external" href="http://numba.pydata.org/">numba</a> in order
to speed up the calculation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.convolve_profile">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">convolve_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#convolve_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.convolve_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolve with Gaussian kernel using constant width in pixels!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>profile</strong><span class="classifier">array, shape (N)</span></dt><dd><p>Input profile to convolve with a Gaussian kernel.</p>
</dd>
<dt><strong>width</strong><span class="classifier">float</span></dt><dd><p>Kernel width (or sigma) of the Gaussian profile in <strong>units of pixels</strong>.
Note – this should <em>not</em> be the FWHM, as is usually used to denote
the resolution element: <cite>width</cite> = FWHM / 2.35482</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>profile_obs</strong><span class="classifier">array, shape(N)</span></dt><dd><p>The convolved version of <cite>profile</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.evaluate_continuum">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">evaluate_continuum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#evaluate_continuum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.evaluate_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the continuum model using Chebyshev polynomials.
All regions are fitted with the same order of polynomials.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Input wavelength grid in Ångstrøm.</p>
</dd>
<dt><strong>pars</strong><span class="classifier">dict(<a href="#id1"><span class="problematic" id="id2">lmfit.Parameters_</span></a>)</span></dt><dd><p>An instance of <a href="#id3"><span class="problematic" id="id4">lmfit.Parameters_</span></a> containing the Chebyshev
coefficients for each region.</p>
</dd>
<dt><strong>reg_num</strong><span class="classifier">int</span></dt><dd><p>The region number, i.e., the index of the region in the list
<code class="xref py py-attr docutils literal notranslate"><span class="pre">VoigtFit.DataSet.regions</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>cont_model</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>The continuum Chebyshev polynomial evaluated at the input wavelengths <cite>x</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.evaluate_optical_depth">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">evaluate_optical_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profile_wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_sys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#evaluate_optical_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.evaluate_optical_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate optical depth based on the component parameters in <cite>pars</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>profile_wl</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Wavelength array in Ångstrøm on which to evaluate the profile.</p>
</dd>
<dt><strong>pars</strong><span class="classifier">dict(<a href="#id5"><span class="problematic" id="id6">lmfit.Parameters_</span></a>)</span></dt><dd><p>An instance of <a href="#id7"><span class="problematic" id="id8">lmfit.Parameters_</span></a> containing the line parameters.</p>
</dd>
<dt><strong>lines</strong><span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code>)</span></dt><dd><p>List of lines to evaluate. Should be a list of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> objects.</p>
</dd>
<dt><strong>z_sys</strong><span class="classifier">float or None</span></dt><dd><p>The systemic redshift, used to determine an effective wavelength range
within which to evaluate the profile. This is handy when fitting very large
regions, such as HI and metal lines together.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tau</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>The resulting optical depth of all <cite>lines</cite> in the wavelength region.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.evaluate_profile">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">evaluate_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_sys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_nsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#evaluate_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.evaluate_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the observed Voigt profile. The calculated optical depth, <cite>tau</cite>,
is converted to observed transmission, <cite>f</cite>:</p>
<div class="math notranslate nohighlight">
\[f = e^{-\tau}\]</div>
<p>The observed transmission is subsequently convolved with the instrumental
broadening profile assumed to be Gaussian with a full-width at half maximum
of res. The resolving power is assumed to be constant in velocity space.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Wavelength array in Ångstrøm on which to evaluate the profile.</p>
</dd>
<dt><strong>pars</strong><span class="classifier">dict(<a href="#id9"><span class="problematic" id="id10">lmfit.Parameters_</span></a>)</span></dt><dd><p>An instance of <a href="#id11"><span class="problematic" id="id12">lmfit.Parameters_</span></a> containing the line parameters.</p>
</dd>
<dt><strong>lines</strong><span class="classifier">list(<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code>)</span></dt><dd><p>List of lines to evaluate. Should be a list of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Line</span></code> objects.</p>
</dd>
<dt><strong>kernel</strong><span class="classifier">np.array, shape (N, M)  or float</span></dt><dd><p>The convolution kernel for each wavelength pixel.
If an array is given, each row of the array must specify
the line-spread function (LSF) at the given wavelength pixel.
The LSF must be normalized!
If a float is given, the resolution FWHM is given in km/s (c/R).
In this case the spectral resolution is assumed
to be constant in velocity space.</p>
</dd>
<dt><strong>z_sys</strong><span class="classifier">float or None</span></dt><dd><p>The systemic redshift, used to determine an effective wavelength range
within which to evaluate the profile. This is handy when fitting very large
regions, such as HI and metal lines together.</p>
</dd>
<dt><strong>sampling</strong><span class="classifier">integer  [default = 3]</span></dt><dd><p>The subsampling factor used for defining the input logarithmically
space wavelength grid. The number of pixels in the evaluation will
be sampling * N, where N is the number of input pixels.
The final profile will be interpolated back onto the original
wavelength grid defined by <cite>x</cite>.</p>
</dd>
<dt><strong>kernel_nsub</strong><span class="classifier">integer</span></dt><dd><p>Kernel subsampling factor relative to the data.
This is only used if the resolution is given as a LSF file.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>profile_obs</strong><span class="classifier">array_like, shape (N)</span></dt><dd><p>Observed line profile convolved with the instrument profile.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.fwhm_to_pixels">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">fwhm_to_pixels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_wl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#fwhm_to_pixels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.fwhm_to_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert spectral resolution in wavelength to pixels
R = lambda / dlambda, where dlambda is the FWHM</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>wl</strong><span class="classifier">array, shape (N)</span></dt><dd><p>Input array of wavelength to evaluate</p>
</dd>
<dt><strong>res_wl</strong><span class="classifier">float</span></dt><dd><p>The input spectral resolution element (FWHM) in Ångström.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>w</strong><span class="classifier">float</span></dt><dd><p>Kernel width converted to pixels (to be used with <a class="reference internal" href="#voigt.convolve_profile" title="voigt.convolve_profile"><code class="xref py py-func docutils literal notranslate"><span class="pre">convolve_profile</span></code></a>).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="voigt.resvel_to_pixels">
<span class="sig-prename descclassname"><span class="pre">voigt.</span></span><span class="sig-name descname"><span class="pre">resvel_to_pixels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/voigt.html#resvel_to_pixels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#voigt.resvel_to_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert spectral resolution in km/s to pixels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>wl</strong><span class="classifier">array, shape (N)</span></dt><dd><p>Input array of wavelength to evaluate</p>
</dd>
<dt><strong>res</strong><span class="classifier">float</span></dt><dd><p>The input spectral velocity resolution in <strong>km/s</strong>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>w</strong><span class="classifier">float</span></dt><dd><p>Kernel width converted to velocity pixels (km/s).
(to be used with convolution of logarithmically-spaced data/models).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-output">
<h2>module <strong>output</strong><a class="headerlink" href="#module-output" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">VoigtFit Parameter Language</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">VoigtFit Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#class-dataset">class <strong>DataSet</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-component">class <strong>Component</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-line">class <strong>Line</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-region">class <strong>Region</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-0">module <strong>voigt</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-output">module <strong>output</strong></a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="physical_model_results.html">Results of Physical Model</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Jens-Kristian Krogager.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>